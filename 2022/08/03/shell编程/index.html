<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="shell 是操作系统的最外层。shell 合并编程语言以控制进程和文件，以及启动和控制其它程序。shell 通过提示您输入，向操作系统解释该输入，然后处理来自操作系统的任何结果输出来管理您与操作系统之间的交互。">
<meta property="og:type" content="article">
<meta property="og:title" content="shell编程">
<meta property="og:url" content="http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/index.html">
<meta property="og:site_name" content="勾三股四">
<meta property="og:description" content="shell 是操作系统的最外层。shell 合并编程语言以控制进程和文件，以及启动和控制其它程序。shell 通过提示您输入，向操作系统解释该输入，然后处理来自操作系统的任何结果输出来管理您与操作系统之间的交互。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/image.assets/1659747737724.png">
<meta property="og:image" content="http://example.com/image.assets/1659747842228.png">
<meta property="og:image" content="http://example.com/image.assets/1659747863045.png">
<meta property="og:image" content="http://example.com/image.assets/1659754821095.png">
<meta property="og:image" content="http://example.com/image.assets/1659754927224.png">
<meta property="og:image" content="http://example.com/image.assets/1659774970166.png">
<meta property="article:published_time" content="2022-08-03T14:23:02.000Z">
<meta property="article:modified_time" content="2022-12-16T14:59:07.603Z">
<meta property="article:author" content="yuan kun">
<meta property="article:tag" content="Linux从入门到放弃">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/image.assets/1659747737724.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>shell编程</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2022/08/07/Disk/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2022/08/01/%E6%96%87%E4%BB%B6%E6%9F%A5%E6%89%BE%E5%92%8C%E6%89%93%E5%8C%85%E5%8E%8B%E7%BC%A9/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&text=shell编程"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&title=shell编程"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&is_video=false&description=shell编程"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=shell编程&body=Check out this article: http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&title=shell编程"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&title=shell编程"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&title=shell编程"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&title=shell编程"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&name=shell编程&description=shell 是操作系统的最外层。shell 合并编程语言以控制进程和文件，以及启动和控制其它程序。shell 通过提示您输入，向操作系统解释该输入，然后处理来自操作系统的任何结果输出来管理您与操作系统之间的交互。"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&t=shell编程"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E5%AE%B9%E7%AE%80%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">内容简述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80"><span class="toc-number">2.</span> <span class="toc-text">1.编程基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E7%A8%8B%E5%BA%8F%E7%BB%84%E6%88%90"><span class="toc-number">2.1.</span> <span class="toc-text">1.1 程序组成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E7%A8%8B%E5%BA%8F%E7%BC%96%E7%A8%8B%E9%A3%8E%E6%A0%BC"><span class="toc-number">2.2.</span> <span class="toc-text">1.2 程序编程风格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80"><span class="toc-number">2.3.</span> <span class="toc-text">1.3 编程语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E7%BC%96%E7%A8%8B%E9%80%BB%E8%BE%91%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F"><span class="toc-number">2.4.</span> <span class="toc-text">1.4 编程逻辑处理方式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-shell-%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">2.shell 脚本语言的基本用法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-shell-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%94%A8%E9%80%94"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 shell 脚本的用途</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-shell%E8%84%9A%E6%9C%AC%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 shell脚本基本结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-shell%E8%84%9A%E6%9C%AC%E5%88%9B%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 shell脚本创建过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-shell%E8%84%9A%E6%9C%AC%E6%B3%A8%E9%87%8A%E8%A7%84%E8%8C%83"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 shell脚本注释规范</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E7%AC%AC%E4%B8%80%E4%B8%AAshell%E8%84%9A%E6%9C%AC"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 第一个shell脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-shell%E8%84%9A%E6%9C%AC%E8%B0%83%E8%AF%95"><span class="toc-number">3.6.</span> <span class="toc-text">2.6 shell脚本调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.</span> <span class="toc-text">2.7 变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-1-%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.1.</span> <span class="toc-text">2.7.1 变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-2-%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.7.2.</span> <span class="toc-text">2.7.2 变量类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-3-shell%E4%B8%AD%E5%8F%98%E9%87%8F%E5%91%BD%E4%BB%A4%E8%A7%84%E5%88%99"><span class="toc-number">3.7.3.</span> <span class="toc-text">2.7.3 shell中变量命令规则</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-3-1-%E5%91%BD%E5%90%8D%E8%A6%81%E6%B1%82"><span class="toc-number">3.7.3.1.</span> <span class="toc-text">2.7.3.1 命名要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-3-2-%E5%91%BD%E4%BB%A4%E4%B9%A0%E6%83%AF"><span class="toc-number">3.7.3.2.</span> <span class="toc-text">2.7.3.2 命令习惯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-4-%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89%E5%92%8C%E5%BC%95%E7%94%A8"><span class="toc-number">3.7.4.</span> <span class="toc-text">2.7.4 变量定义和引用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-5-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.5.</span> <span class="toc-text">2.7.5 环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-6-%E5%8F%AA%E8%AF%BB%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.6.</span> <span class="toc-text">2.7.6 只读变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-7-%E4%BD%8D%E7%BD%AE%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.7.</span> <span class="toc-text">2.7.7 位置变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-8-%E5%88%A9%E7%94%A8%E8%BD%AF%E9%93%BE%E6%8E%A5%E5%AE%9E%E7%8E%B0%E5%90%8C%E4%B8%80%E4%B8%AA%E8%84%9A%E6%9C%AC%E4%B8%8D%E5%90%8C%E5%8A%9F%E8%83%BD"><span class="toc-number">3.7.8.</span> <span class="toc-text">2.7.8  利用软链接实现同一个脚本不同功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-9-%E9%80%80%E5%87%BA%E7%8A%B6%E6%80%81%E7%A0%81%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.9.</span> <span class="toc-text">2.7.9 退出状态码变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-10-%E8%84%9A%E6%9C%AC%E5%AE%89%E5%85%A8%E5%92%8C-set"><span class="toc-number">3.7.10.</span> <span class="toc-text">2.7.10 脚本安全和 set</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8-%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97"><span class="toc-number">3.8.</span> <span class="toc-text">2.8 算术运算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-9-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><span class="toc-number">3.9.</span> <span class="toc-text">2.9 逻辑运算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-10-%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95%E5%91%BD%E4%BB%A4"><span class="toc-number">3.10.</span> <span class="toc-text">2.10 条件测试命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-1-%E5%8F%98%E9%87%8F%E6%B5%8B%E8%AF%95"><span class="toc-number">3.10.1.</span> <span class="toc-text">2.10.1 变量测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-2-%E6%95%B0%E5%80%BC%E6%B5%8B%E8%AF%95"><span class="toc-number">3.10.2.</span> <span class="toc-text">2.10.2 数值测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-3-%E7%AE%97%E6%9C%AF%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%AF%94%E8%BE%83"><span class="toc-number">3.10.3.</span> <span class="toc-text">2.10.3 算术表达式比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-4-%E5%AD%97%E7%AC%A6%E7%AA%9C%E6%B5%8B%E8%AF%95"><span class="toc-number">3.10.4.</span> <span class="toc-text">2.10.4 字符窜测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-5-%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="toc-number">3.10.5.</span> <span class="toc-text">2.10.5 文件测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-11-%E5%85%B3%E4%BA%8E%EF%BC%88%EF%BC%89%E5%92%8C"><span class="toc-number">3.11.</span> <span class="toc-text">2.11 关于（）和{}</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-12-%E7%BB%84%E5%90%88%E6%B5%8B%E8%AF%95"><span class="toc-number">3.12.</span> <span class="toc-text">2.12 组合测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-12-1-%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">3.12.1.</span> <span class="toc-text">2.12.1 第一种方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-12-2-%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">3.12.2.</span> <span class="toc-text">2.12.2 第二种方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-13-%E4%BD%BF%E7%94%A8read%E5%91%BD%E4%BB%A4%E6%9D%A5%E6%8E%A5%E5%8F%97%E8%BE%93%E5%85%A5"><span class="toc-number">3.13.</span> <span class="toc-text">2.13 使用read命令来接受输入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E6%9D%A1%E4%BB%B6%E9%80%89%E6%8B%A9if"><span class="toc-number">4.</span> <span class="toc-text">3  条件选择if</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%BE%AA%E7%8E%AF"><span class="toc-number">5.</span> <span class="toc-text">4 循环</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-for%E5%BE%AA%E7%8E%AF"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 for循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-while%E5%BE%AA%E7%8E%AF"><span class="toc-number">5.2.</span> <span class="toc-text">4.2 while循环</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E5%85%B6%E4%BB%96%E8%84%9A%E6%9C%AC%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7"><span class="toc-number">6.</span> <span class="toc-text">5 其他脚本相关工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-trap%E5%91%BD%E4%BB%A4"><span class="toc-number">6.1.</span> <span class="toc-text">5.1 trap命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-except%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E5%8C%96%E7%9A%84%E9%9D%9E%E4%BA%A4%E4%BA%92%E6%93%8D%E4%BD%9C"><span class="toc-number">6.2.</span> <span class="toc-text">5. 2 except实现自动化的非交互操作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E6%95%B0%E7%BB%84"><span class="toc-number">7.</span> <span class="toc-text">6 数组</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E6%95%B0%E7%BB%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">7.1.</span> <span class="toc-text">6.1 数组介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E5%A3%B0%E6%98%8E%E6%95%B0%E7%BB%84"><span class="toc-number">7.2.</span> <span class="toc-text">6.2 声明数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E6%95%B0%E7%BB%84%E8%B5%8B%E5%80%BC"><span class="toc-number">7.3.</span> <span class="toc-text">6.3 数组赋值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-%E6%98%BE%E7%A4%BA%E6%89%80%E6%9C%89%E6%95%B0%E7%BB%84"><span class="toc-number">7.4.</span> <span class="toc-text">6.4 显示所有数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-%E5%BC%95%E7%94%A8%E6%95%B0%E7%BB%84"><span class="toc-number">7.5.</span> <span class="toc-text">6.5 引用数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6-%E5%88%A0%E9%99%A4%E6%95%B0%E7%BB%84"><span class="toc-number">7.6.</span> <span class="toc-text">6.6 删除数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-7-%E6%95%B0%E7%BB%84%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">7.7.</span> <span class="toc-text">6.7 数组数据处理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86"><span class="toc-number">8.</span> <span class="toc-text">7 字符串处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%87%E7%89%87"><span class="toc-number">8.1.</span> <span class="toc-text">7.1 字符串切片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E5%9F%BA%E4%BA%8E%E6%A8%A1%E5%BC%8F%E5%8F%96%E5%AD%90%E4%B8%B2"><span class="toc-number">8.2.</span> <span class="toc-text">7.2 基于模式取子串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E6%9F%A5%E6%89%BE%E5%92%8C%E6%9B%BF%E6%8D%A2"><span class="toc-number">8.3.</span> <span class="toc-text">7.3 查找和替换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-%E6%9F%A5%E6%89%BE%E5%92%8C%E5%88%A0%E9%99%A4"><span class="toc-number">8.4.</span> <span class="toc-text">7.4 查找和删除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-5-%E5%AD%97%E7%AC%A6%E5%A4%A7%E5%B0%8F%E5%86%99%E8%BD%AC%E6%8D%A2"><span class="toc-number">8.5.</span> <span class="toc-text">7.5 字符大小写转换</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        shell编程
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">勒马听风</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-08-03T14:23:02.000Z" itemprop="datePublished">2022-08-03</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Linux%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/" rel="tag">Linux从入门到放弃</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="内容简述"><a href="#内容简述" class="headerlink" title="内容简述"></a>内容简述</h1><p>shell 是操作系统的最外层。shell 合并编程语言以控制进程和文件，以及启动和控制其它程序。shell 通过提示您输入，向操作系统解释该输入，然后处理来自操作系统的任何结果输出来管理您与操作系统之间的交互。</p>
<h1 id="1-编程基础"><a href="#1-编程基础" class="headerlink" title="1.编程基础"></a>1.编程基础</h1><p>Linus：Talk is cheap, show me the code</p>
<h2 id="1-1-程序组成"><a href="#1-1-程序组成" class="headerlink" title="1.1 程序组成"></a>1.1 程序组成</h2><ul>
<li>程序：算法+数据结构</li>
<li>算法：处理数据的方式</li>
<li>数据结构：数据在计算机中的类型和组织方式</li>
<li>数据：是程序的核心，程序为数据提供服务</li>
</ul>
<h2 id="1-2-程序编程风格"><a href="#1-2-程序编程风格" class="headerlink" title="1.2 程序编程风格"></a>1.2 程序编程风格</h2><ul>
<li>面向过程语言<ul>
<li>做一件事情，排出个步骤，第一步干什么，第二步干什么，如果出现情况A，做什么处理，如果出现了情况B，做什么处理</li>
<li>问题规模小，可以步骤化，按部就班处理</li>
<li>以指令为中心，数据服务于指令</li>
<li>C，shell</li>
</ul>
</li>
<li>面向对象语言<ul>
<li>将编程看成是一个事物，对外界来说，事物是直接使用的,不用关心事物内部的情况。而编程就是设置事物能够完成功能。</li>
<li>一种认识世界、分析世界的方法论。将万事万物抽象为各种对象</li>
<li>类是抽象的概念，是万事万物的抽象，是一类事物的共同特征的集合</li>
<li>对象是类的具体实现，是一个实体</li>
<li>问题规模大，复杂系统</li>
<li>以数据为中心，指令服务于数据</li>
<li>java，C#，python，golang等</li>
</ul>
</li>
</ul>
<h2 id="1-3-编程语言"><a href="#1-3-编程语言" class="headerlink" title="1.3 编程语言"></a>1.3 编程语言</h2><p><strong>编程语言排行榜链接</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.tiobe.com/tiobe-index/</span><br></pre></td></tr></table></figure>
<p>计算机：运行二进制指令<br>编程语言：人与计算机之间交互的语言。分为两种：低级语言和高级语言  </p>
<ul>
<li>低级编程语言：  <ul>
<li>机器：二进制的0和1的序列，称为机器指令。与自然语言差异太大，难懂、难写  </li>
<li>汇编：用一些助记符号替代机器指令，称为汇编语言<br>如：ADD A,B 将寄存器A的数与寄存器B的数相加得到的数放到寄存器A中<br>汇编语言写好的程序需要汇编程序转换成机器指令<br>汇编语言稍微好理解，即机器指令对应的助记符，助记符更接近自然语言</li>
</ul>
</li>
<li>高级编程语言：  <ul>
<li>编译：高级语言–&gt;编译器–&gt;机器代码文件–&gt;执行，如：C，C++  </li>
<li>解释：高级语言–&gt;执行–&gt;解释器–&gt;机器代码，如：shell，python，php，JavaScript，perl</li>
</ul>
</li>
<li>编译和解释型语言<br><img src="/../image.assets/1659747737724.png" alt="1659747737724"></li>
</ul>
<h2 id="1-4-编程逻辑处理方式"><a href="#1-4-编程逻辑处理方式" class="headerlink" title="1.4 编程逻辑处理方式"></a>1.4 编程逻辑处理方式</h2><p><img src="/../image.assets/1659747842228.png" alt="1659747842228"></p>
<p><img src="/../image.assets/1659747863045.png" alt="1659747863045"></p>
<p><strong>三种处理逻辑</strong></p>
<ul>
<li>顺序执行：程序按从上到下顺序执行</li>
<li>选择执行：程序执行过程中，根据条件的不同，进行选择不同分支继续执行</li>
<li>循环执行：程序执行过程中需要重复执行多次某段语句</li>
</ul>
<h1 id="2-shell-脚本语言的基本用法"><a href="#2-shell-脚本语言的基本用法" class="headerlink" title="2.shell 脚本语言的基本用法"></a>2.shell 脚本语言的基本用法</h1><h2 id="2-1-shell-脚本的用途"><a href="#2-1-shell-脚本的用途" class="headerlink" title="2.1 shell 脚本的用途"></a>2.1 shell 脚本的用途</h2><ul>
<li>将简单的命令组合完成复杂的工作,自动化执行命令,提高工作效率</li>
<li>减少手工命令的输入，一定程度上避免人为错误</li>
<li>将软件或应用的安装及配置实现标准化</li>
<li>用于实现日常性的,重复性的,非交互式的运维工作,如:文件打包压缩备份,监控系统运行状态并实现告警等</li>
</ul>
<h2 id="2-2-shell脚本基本结构"><a href="#2-2-shell脚本基本结构" class="headerlink" title="2.2 shell脚本基本结构"></a>2.2 shell脚本基本结构</h2><p><strong>shell脚本编程：是基于过程式、解释执行的语言</strong>  </p>
<hr>
<p><strong>编程语言的基本结构：</strong></p>
<ul>
<li>各种系统命令的组合</li>
<li>数据存储：变量、数组</li>
<li>表达式：a + b</li>
<li>控制语句：if</li>
</ul>
<p>shell脚本：包含一些命令或声明，并符合一定格式的文本文件<br>格式要求：首行shebang机制</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">#!/usr/bin/python</span><br><span class="line">#!/usr/bin/perl</span><br><span class="line">#!/usr/bin/ruby</span><br><span class="line">#!/usr/bin/lua</span><br></pre></td></tr></table></figure>

<h2 id="2-3-shell脚本创建过程"><a href="#2-3-shell脚本创建过程" class="headerlink" title="2.3 shell脚本创建过程"></a>2.3 shell脚本创建过程</h2><p><strong>第一步：使用文本编编辑器来创建文本文件</strong></p>
<p><strong>第一行必须包括shell声明序列：#!</strong><br>示例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash	<span class="comment"># 使用bash，添加注释,注释以#开头</span></span>	</span><br></pre></td></tr></table></figure>

<p>第二步：加执行权限<br>给予执行权限，在命令行上指定脚本的绝对或相对路径<br>第三步：运行脚本<br>直接运行解释器，将脚本作为解释器程序的参数运行</p>
<p><strong>扩展：查看当前使用的是何种shell，终端输入：echo $SHELL</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:~# echo $SHELL</span><br><span class="line">/bin/bash</span><br><span class="line">root@ubuntu200404:~#</span><br></pre></td></tr></table></figure>

<h2 id="2-4-shell脚本注释规范"><a href="#2-4-shell脚本注释规范" class="headerlink" title="2.4 shell脚本注释规范"></a>2.4 shell脚本注释规范</h2><ul>
<li>第一行一般为调用使用的语言</li>
<li>程序名，避免更改文件名为无法找到正确的文件</li>
<li>版本号</li>
<li>更改后的时间</li>
<li>作者相关信息</li>
<li>该程序的作用，及注意事项</li>
<li>最后是各版本的更新简要说明</li>
</ul>
<h2 id="2-5-第一个shell脚本"><a href="#2-5-第一个shell脚本" class="headerlink" title="2.5 第一个shell脚本"></a>2.5 第一个shell脚本</h2><p><strong>范例：第一个shell脚本hello world</strong></p>
<p><strong>参考文档：</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://zh.wikipedia.org/wiki/Hello_World</span><br><span class="line">https://zh.wikipedia.org/wiki/Hello_World%E7%A8%8B%E5%BA%8F%E6%A0%B7%E4%BE%8B</span><br></pre></td></tr></table></figure>

<p>(程序样例)[<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Hello_World]">https://zh.wikipedia.org/wiki/Hello_World]</a></p>
<p><strong>第一步：vim创建hello.sh文本</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:~# vim hello.sh</span><br></pre></td></tr></table></figure>

<p><strong>第二步：声明序列和添加脚本名称、日期等</strong></p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">#******************</span><br><span class="line">#filename:hello.<span class="keyword">sh</span></span><br><span class="line">#Dat<span class="variable">a:2022</span>-<span class="number">08</span>-<span class="number">06</span></span><br><span class="line">#author:admin</span><br><span class="line">#******************</span><br></pre></td></tr></table></figure>

<p><strong>第三步：编写代码</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">经典写法</span></span><br><span class="line">echo &quot;hello, world&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">流行写法</span></span><br><span class="line">echo &#x27;Hello, world!&#x27;</span><br></pre></td></tr></table></figure>

<p><strong>第四步：执行shell脚本</strong></p>
<p>方法一：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:~# bash hello.sh </span><br><span class="line">hello world!</span><br><span class="line">******************</span><br><span class="line">hello world!</span><br><span class="line">root@ubuntu200404:~# </span><br></pre></td></tr></table></figure>

<p>方法二：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# cat /data/scripts/hello.sh | bash</span><br><span class="line">hello world!</span><br><span class="line">******************</span><br><span class="line">hello world!</span><br><span class="line">root@ubuntu200404:/data/scripts#</span><br></pre></td></tr></table></figure>

<p>方法三：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# bash &lt; /data/scripts/hello.sh </span><br><span class="line">hello world!</span><br><span class="line">******************</span><br><span class="line">hello world!</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p>方法四：添加执行权限使用绝对路径和相对路径</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">绝对路径</span></span><br><span class="line">root@ubuntu200404:/data/scripts# /data/scripts/hello.sh </span><br><span class="line">hello world!</span><br><span class="line">******************</span><br><span class="line">hello world!</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">相对路径</span></span><br><span class="line">root@ubuntu200404:/data/scripts# pwd</span><br><span class="line">/data/scripts</span><br><span class="line">root@ubuntu200404:/data/scripts# ./hello.sh </span><br><span class="line">hello world!</span><br><span class="line">******************</span><br><span class="line">hello world!</span><br><span class="line">root@ubuntu200404:/data/scripts#</span><br></pre></td></tr></table></figure>

<p>方法五：将脚本添加到path变量中</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">当前path位置</span></span><br><span class="line">root@ubuntu200404:/data/scripts# echo $PATH</span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</span><br><span class="line">root@ubuntu200404:/data/scripts#</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">给hello.sh文件创建软链接放到/usr/local/bin目录下</span></span><br><span class="line">root@ubuntu200404:/data/scripts# ln -s /data/scripts/hello.sh /usr/local/bin/ </span><br><span class="line">root@ubuntu200404:/data/scripts# ls /usr/local/bin/						</span><br><span class="line">hello.sh</span><br><span class="line">root@ubuntu200404:/data/scripts#</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行shell脚本</span></span><br><span class="line">root@ubuntu200404:/data/scripts# hello.sh </span><br><span class="line">hello world!</span><br><span class="line">******************</span><br><span class="line">hello world!</span><br><span class="line">root@ubuntu200404:/data/scripts#</span><br></pre></td></tr></table></figure>

<p>方法六：本方法可以实现执行远程主机的shell脚本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">扩展：curl加-s选项不显示下载信息</span></span><br><span class="line">root@ubuntu200404:/data# curl -s http://wangxiaochun.com/testdir/hello.sh |bash</span><br><span class="line">hello, world</span><br><span class="line">Hello, world!</span><br><span class="line">root@ubuntu200404:/data# </span><br></pre></td></tr></table></figure>

<p>案例：备份脚本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">脚本内容</span></span><br><span class="line">root@ubuntu200404:/data/scripts# cat -n bacup.sh </span><br><span class="line">     1	#!/bin/bash</span><br><span class="line">     2	#------------------</span><br><span class="line">     3	#filename:bacup.sh</span><br><span class="line">     4	#备份脚本</span><br><span class="line">     5	#------------------</span><br><span class="line">     6	</span><br><span class="line">     7	</span><br><span class="line">     8	tar zcf /data/scripts-`date +%F_%s`.tar.gz /data/ &amp;&gt; /dev/null</span><br><span class="line">     9	</span><br><span class="line">    10	echo -e &quot;\E[1;32mbacup is success!\E[0m&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行脚本</span></span><br><span class="line">root@ubuntu200404:/data/scripts# bash bacup.sh </span><br><span class="line">bacup is success!</span><br><span class="line">root@ubuntu200404:/data/scripts#</span><br></pre></td></tr></table></figure>

<h2 id="2-6-shell脚本调试"><a href="#2-6-shell脚本调试" class="headerlink" title="2.6 shell脚本调试"></a>2.6 shell脚本调试</h2><p><strong>只检测脚本中的语法错误，但无法检查出命令错误，但不真正执行脚本</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -n /path/to/some_script</span><br></pre></td></tr></table></figure>

<p><strong>调试并执行</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -x /path/to/some_script</span><br></pre></td></tr></table></figure>

<p><strong>案例1：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# bash -x hello.sh </span><br><span class="line">+ echo &#x27;hello world!&#x27;</span><br><span class="line">hello world!</span><br><span class="line">+ echo &#x27;******************&#x27;</span><br><span class="line">******************</span><br><span class="line">+ echo &#x27;hello world!&#x27;</span><br><span class="line">hello world!</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p><strong>案例2:多行重定向</strong></p>
<p>脚本内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">多行重定向</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">data:2022-08-06</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">author:admin</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">--------------------------------------------</span></span><br><span class="line"></span><br><span class="line">echo start</span><br><span class="line"></span><br><span class="line">cat &gt;/data/demo.conf &lt;&lt;EOF</span><br><span class="line">line 1</span><br><span class="line">line 2</span><br><span class="line">line 3</span><br><span class="line">EOF </span><br><span class="line"></span><br><span class="line">echo end</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p>检查错误：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# bash -n demo1.sh </span><br><span class="line">demo1.sh: line 17: warning: here-document at line 11 delimited by end-of-file (wanted `EOF&#x27;)</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p>检查出第十七行有错误，肉眼观察没有错误，这是因为有些错误不显示在屏幕上的，可以通过cat -A filename或者在vi命令行模式下输入：set list</p>
<p><img src="/../image.assets/1659754821095.png" alt="1659754821095"></p>
<p>使用cat -A filename命令后发现EOF后面多了个空格导致错误。删除掉空格脚本即可成功运行。</p>
<p>在vi命令行模式下输入set list</p>
<p><img src="/../image.assets/1659754927224.png" alt="1659754927224"></p>
<p><strong>总结：脚本错误常见的有三种</strong></p>
<ul>
<li>语法错误，会导致后续的命令不继续执行，可以用bash -n 检查错误，提示的出错行数不一定是准<br>确的</li>
<li>命令错误，默认后续的命令还会继续执行，用bash -n 无法检查出来 ，可以使用 bash -x 进行观察</li>
<li>逻辑错误：只能使用 bash -x 进行观察</li>
</ul>
<h2 id="2-7-变量"><a href="#2-7-变量" class="headerlink" title="2.7 变量"></a>2.7 变量</h2><h3 id="2-7-1-变量"><a href="#2-7-1-变量" class="headerlink" title="2.7.1 变量"></a>2.7.1 变量</h3><p><strong>变量表示命名的内存空间，将数据放在内存空间中，通过变量名引用，获取数据</strong>  </p>
<hr>
<h3 id="2-7-2-变量类型"><a href="#2-7-2-变量类型" class="headerlink" title="2.7.2 变量类型"></a>2.7.2 变量类型</h3><p><strong>变量类型：</strong></p>
<ul>
<li>内置变量，如：PS1，PATH，UID，HOSTNAME，$$，BASHPID，PPID，$?，HISTSIZE</li>
<li>用户自定义变量</li>
</ul>
<p><strong>不同的变量存放的数据不同，决定了以下</strong></p>
<ul>
<li>数据存储方式</li>
<li>参与的运算</li>
<li>表示的数据范围</li>
</ul>
<p><strong>变量数据类型：</strong></p>
<ul>
<li>字符</li>
<li>数值：整型、浮点型,bash 不支持浮点数</li>
</ul>
<h3 id="2-7-3-shell中变量命令规则"><a href="#2-7-3-shell中变量命令规则" class="headerlink" title="2.7.3 shell中变量命令规则"></a>2.7.3 shell中变量命令规则</h3><h4 id="2-7-3-1-命名要求"><a href="#2-7-3-1-命名要求" class="headerlink" title="2.7.3.1 命名要求"></a>2.7.3.1 命名要求</h4><ul>
<li><p>区分大小写</p>
</li>
<li><p>不能使程序中的保留字和内置变量：如：if, for<br>只能使用数字、字母及下划线，且不能以数字开头，注意：不支持短横线 “ - ”，和主机名相反</p>
</li>
<li><p>只能使用数字、字母及下划线，且不能以数字开头，注意：不支持短横线 “ - ”，和主机名相反</p>
</li>
</ul>
<h4 id="2-7-3-2-命令习惯"><a href="#2-7-3-2-命令习惯" class="headerlink" title="2.7.3.2 命令习惯"></a>2.7.3.2 命令习惯</h4><ul>
<li>见名知义，用英文单词命名，并体现出实际作用，不要用简写，如：ATM</li>
<li>变量名大写</li>
<li>局部变量小写</li>
<li>函数名小写</li>
<li>大驼峰StudentFirstName,由多个单词组成，且每个单词的首字母是大写，其它小写</li>
<li>小驼峰studentFirstName ,由多个单词组成，第一个单词的首字母小写，后续每个单词的首字母是大写，其它小写</li>
<li>下划线: student_name</li>
</ul>
<h3 id="2-7-4-变量定义和引用"><a href="#2-7-4-变量定义和引用" class="headerlink" title="2.7.4 变量定义和引用"></a>2.7.4 变量定义和引用</h3><p><strong>变量的生效范围等标准划分变量类型</strong></p>
<ul>
<li>普通变量：生效范围为当前shell进程；对当前shell之外的其它shell进程，包括当前shell的子shell进程均无效</li>
<li>环境变量：生效范围为当前shell进程及其子进程</li>
<li>本地变量：生效范围为当前shell进程中某代码片断，通常指函数</li>
</ul>
<p><strong>变量赋值：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=&#x27;value&#x27;</span><br></pre></td></tr></table></figure>

<p><strong>value 可以是以下多种形式</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">直接字串：name=&#x27;root&#x27;</span><br><span class="line">变量引用：name=&quot;$USER&quot;</span><br><span class="line">命令引用：name=`COMMAND` 或者 name=$(COMMAND)</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>变量赋值是临时生效，当退出终端后，变量会自动删除，无法持久保存，脚本中的变量会随着脚本结束，也会自动删除</p>
<p><strong>变量引用：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">name</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;name&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>弱引用和强引用</strong></p>
<ul>
<li>“$name” 弱引用，其中的变量引用会被替换为变量值</li>
<li>‘$name’ 强引用，其中的变量引用不会被替换为变量值，而保持原字符串</li>
</ul>
<p><strong>范例：变量的各种赋值方式和引用</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">方式1：</span><br><span class="line">root@ubuntu200404:/data/scripts# TITLE=cto</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $TITLE</span><br><span class="line">cto</span><br><span class="line">root@ubuntu200404:/data/scripts#</span><br><span class="line"></span><br><span class="line">方式二：</span><br><span class="line">root@ubuntu200404:/data/scripts# T=ceo</span><br><span class="line">root@ubuntu200404:/data/scripts# NAME=$T</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $NAME</span><br><span class="line">ceo</span><br><span class="line">root@ubuntu200404:/data/scripts#</span><br><span class="line"></span><br><span class="line">方式三：</span><br><span class="line">root@ubuntu200404:/data/scripts# NAME=`whoami`</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $NAME</span><br><span class="line">root</span><br><span class="line">root@ubuntu200404:/data/scripts#</span><br><span class="line"></span><br><span class="line">方式四：</span><br><span class="line">root@ubuntu200404:/data/scripts# seq 10</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">root@ubuntu200404:/data/scripts#</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">弱引用</span></span><br><span class="line">root@ubuntu200404:/data/scripts# echo &quot;$NUM&quot;</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p><strong>删除变量： unset name</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">unset &lt;name&gt;</span><br><span class="line">案例：</span><br><span class="line">root@ubuntu200404:/data/scripts# NUM=`seq 10`</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $NUM</span><br><span class="line">1 2 3 4 5 6 7 8 9 10</span><br><span class="line">root@ubuntu200404:/data/scripts# unset NUM</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $NUM</span><br><span class="line"></span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p><strong>显示已有的变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set</span><br></pre></td></tr></table></figure>

<h3 id="2-7-5-环境变量"><a href="#2-7-5-环境变量" class="headerlink" title="2.7.5 环境变量"></a>2.7.5 环境变量</h3><p><strong>环境变量：</strong></p>
<ul>
<li>可以使子进程（包括孙子进程）继承父进程的变量，但是无法让父进程使用子进程的变量</li>
<li>一旦子进程修改从父进程继承的变量，将会新的值传递给孙子进</li>
<li>一般只在系统配置文件中使用，在脚本中较少使用</li>
</ul>
<p><strong>变量声明和赋值：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#声明并赋值</span><br><span class="line">export name=VALUE</span><br><span class="line">declare -x name=VALUE</span><br><span class="line">#或者分两步实现</span><br><span class="line">name=VALUE</span><br><span class="line">export name</span><br></pre></td></tr></table></figure>

<p><strong>变量引用：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$name</span><br><span class="line">$&#123;name&#125;</span><br></pre></td></tr></table></figure>

<p><strong>显示所有环境变量：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">env</span><br><span class="line">printenv</span><br><span class="line">export</span><br><span class="line">declare -x</span><br></pre></td></tr></table></figure>

<p><strong>查看指定进程的环境变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/$PID/environ</span><br></pre></td></tr></table></figure>

<p><strong>删除变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unset name</span><br></pre></td></tr></table></figure>

<p><strong>bash内建的环境变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PATH</span><br><span class="line">SHELL</span><br><span class="line">USER</span><br><span class="line">UID</span><br><span class="line">HOME</span><br><span class="line">PWD</span><br><span class="line">SHLVL #shell的嵌套层数，即深度</span><br><span class="line">LANG</span><br><span class="line">MAIL</span><br><span class="line">HOSTNAME</span><br><span class="line">HISTSIZE</span><br><span class="line">_ #下划线,表示前一命令的最后一个参数</span><br></pre></td></tr></table></figure>

<p><strong>扩展：pstree -p</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# pstree -p</span><br><span class="line">systemd(1)─┬─VGAuthService(757)</span><br><span class="line">           ├─accounts-daemon(811)─┬─&#123;accounts-daemon&#125;(818)</span><br><span class="line">           │                      └─&#123;accounts-daemon&#125;(864)</span><br><span class="line">           ├─atd(837)</span><br><span class="line">           ├─cron(815)</span><br><span class="line">           ├─dbus-daemon(817)</span><br><span class="line">           ├─irqbalance(824)───&#123;irqbalance&#125;(853)</span><br><span class="line">           ├─login(1206)───bash(1402)───sudo(1413)───bash(1420)</span><br><span class="line">           ├─multipathd(702)─┬─&#123;multipathd&#125;(703)</span><br><span class="line">           │                 ├─&#123;multipathd&#125;(704)</span><br><span class="line">           │                 ├─&#123;multipathd&#125;(705)</span><br><span class="line">           │                 ├─&#123;multipathd&#125;(706)</span><br><span class="line">           │                 ├─&#123;multipathd&#125;(707)</span><br><span class="line">           │                 └─&#123;multipathd&#125;(708)</span><br><span class="line">           ├─networkd-dispat(825)</span><br><span class="line">           ├─polkitd(872)─┬─&#123;polkitd&#125;(875)</span><br><span class="line">           │              └─&#123;polkitd&#125;(877)</span><br><span class="line">           ├─rsyslogd(826)─┬─&#123;rsyslogd&#125;(839)</span><br><span class="line">           │               ├─&#123;rsyslogd&#125;(840)</span><br><span class="line">           │               └─&#123;rsyslogd&#125;(841)</span><br><span class="line">           ├─snapd(828)─┬─&#123;snapd&#125;(915)</span><br><span class="line">           │            ├─&#123;snapd&#125;(916)</span><br><span class="line">           │            ├─&#123;snapd&#125;(917)</span><br><span class="line">           │            ├─&#123;snapd&#125;(918)</span><br><span class="line">           │            ├─&#123;snapd&#125;(919)</span><br><span class="line">           │            ├─&#123;snapd&#125;(945)</span><br><span class="line">           │            ├─&#123;snapd&#125;(946)</span><br><span class="line">           │            ├─&#123;snapd&#125;(952)</span><br><span class="line">           │            ├─&#123;snapd&#125;(954)</span><br><span class="line">           │            └─&#123;snapd&#125;(975)</span><br><span class="line">           ├─sshd(859)─┬─sshd(3292)───bash(3421)───pstree(13708)</span><br><span class="line">           │           └─sshd(6603)───bash(6736)</span><br><span class="line">           ├─systemd(1477)───(sd-pam)(1478)</span><br><span class="line">           ├─systemd(1392)───(sd-pam)(1393)</span><br><span class="line">           ├─systemd-journal(495)</span><br><span class="line">           ├─systemd-logind(830)</span><br><span class="line">           ├─systemd-network(2826)</span><br><span class="line">           ├─systemd-resolve(799)</span><br><span class="line">           ├─systemd-timesyn(746)───&#123;systemd-timesyn&#125;(778)</span><br><span class="line">           ├─systemd-udevd(525)</span><br><span class="line">           ├─udisksd(836)─┬─&#123;udisksd&#125;(863)</span><br><span class="line">           │              ├─&#123;udisksd&#125;(866)</span><br><span class="line">           │              ├─&#123;udisksd&#125;(883)</span><br><span class="line">           │              └─&#123;udisksd&#125;(906)</span><br><span class="line">           ├─unattended-upgr(878)───&#123;unattended-upgr&#125;(908)</span><br><span class="line">           ├─upowerd(2940)─┬─&#123;upowerd&#125;(2942)</span><br><span class="line">           │               └─&#123;upowerd&#125;(2943)</span><br><span class="line">           └─vmtoolsd(758)─┬─&#123;vmtoolsd&#125;(781)</span><br><span class="line">                           └─&#123;vmtoolsd&#125;(2774)</span><br></pre></td></tr></table></figure>
<h3 id="2-7-6-只读变量"><a href="#2-7-6-只读变量" class="headerlink" title="2.7.6 只读变量"></a>2.7.6 只读变量</h3><p><strong>只读变量：只能声明定义，但后续不能修改和删除，即常量</strong><br><strong>声明只读变量：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">readonly name</span><br><span class="line">declare -r name</span><br></pre></td></tr></table></figure>

<p><strong>查看只读变量：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">readonly [-p]</span><br><span class="line">declare -r</span><br></pre></td></tr></table></figure>

<p><strong>范例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# readonly PI=3.14159</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $PI</span><br><span class="line">3.14159</span><br><span class="line">root@ubuntu200404:/data/scripts# PI=3.14</span><br><span class="line">-bash: PI: readonly variable</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<h3 id="2-7-7-位置变量"><a href="#2-7-7-位置变量" class="headerlink" title="2.7.7 位置变量"></a>2.7.7 位置变量</h3><p><strong>位置变量：在bash shell中内置的变量, 在脚本代码中调用通过命令行传递给脚本的参数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$1, $2, ... 对应第1个、第2个等参数，shift [n]换位置</span><br><span class="line">$0 命令本身,包括路径</span><br><span class="line">$* 传递给脚本的所有参数，全部参数合为一个字符串</span><br><span class="line">$@ 传递给脚本的所有参数，每个参数为独立字符串</span><br><span class="line">$# 传递给脚本的参数的个数</span><br><span class="line">注意：$@ $* 只在被双引号包起来的时候才会有差异</span><br></pre></td></tr></table></figure>

<p><strong>清空所有位置变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set --</span><br></pre></td></tr></table></figure>

<p><strong>范例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">echo &quot;1st arg is $1&quot;</span><br><span class="line">echo &quot;2st arg is $2&quot;</span><br><span class="line">echo &quot;3st arg is $3&quot;</span><br><span class="line">echo &quot;10st arg is $&#123;10&#125;&quot;</span><br><span class="line">echo &quot;11st arg is $&#123;11&#125;&quot;</span><br><span class="line">echo &quot;The number of arg is $#&quot;</span><br><span class="line">echo &quot;All args are $*&quot;</span><br><span class="line">echo &quot;All args are $@&quot;</span><br><span class="line">echo &quot;The scriptname is `basename $0`&quot;</span><br><span class="line">root@ubuntu200404:/data/scripts# bash args.sh &#123;a..z&#125;</span><br><span class="line">1st arg is a</span><br><span class="line">2st arg is b</span><br><span class="line">3st arg is c</span><br><span class="line">10st arg is j</span><br><span class="line">11st arg is k</span><br><span class="line">The number of arg is 26</span><br><span class="line">All args are a b c d e f g h i j k l m n o p q r s t u v w x y z</span><br><span class="line">All args are a b c d e f g h i j k l m n o p q r s t u v w x y z</span><br><span class="line">The scriptname is args.sh</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p><strong>范例：删库跑路之安全命令</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># 查看命令</span><br><span class="line">root@ubuntu200404:/data/scripts# cat /data/scripts/rm.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">#-----------------</span><br><span class="line">#删库跑路之安全命令</span><br><span class="line">#-----------------</span><br><span class="line">#filename:rm.sh</span><br><span class="line">#data:2022-08-06</span><br><span class="line">#author:admin</span><br><span class="line">#-----------------</span><br><span class="line"></span><br><span class="line">WARNING_COLOR=&quot;echo -e \E[1;31m&quot;</span><br><span class="line"></span><br><span class="line">END=&quot;\E[0m&quot;</span><br><span class="line"></span><br><span class="line">DIR=/tmp/`date +%F_%H-%M-%S`</span><br><span class="line"></span><br><span class="line">mkdir $&#123;DIR&#125;</span><br><span class="line"></span><br><span class="line">mv $* $&#123;DIR&#125;</span><br><span class="line"></span><br><span class="line">$&#123;WARNING_COLOR&#125;Move $* to $&#123;END&#125;</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br><span class="line"></span><br><span class="line"># 给/data/scripts/rm.sh添加执行权限</span><br><span class="line">root@ubuntu200404:/data/scripts# chmod a+x /data/scripts/rm.sh</span><br><span class="line"></span><br><span class="line"># 添加别名</span><br><span class="line">root@ubuntu200404:/data/scripts#alias rm=&#x27;/data/scripts/rm.sh&#x27;</span><br><span class="line"></span><br><span class="line">root@ubuntu200404:/data/scripts# touch &#123;1..9&#125;.TXT</span><br><span class="line">root@ubuntu200404:/data/scripts# rm *.TXT</span><br><span class="line">Move 1.TXT 2.TXT 3.TXT 4.TXT 5.TXT 6.TXT 7.TXT 8.TXT 9.TXT to </span><br></pre></td></tr></table></figure>

<p>*<em>范例：$<em>和$@的区别</em></em></p>
<ol>
<li>当 $* 和 $@ 不带双引号时它们两个是没有区别的，都是接收所有参数然后分别单独处理每个参数！而当$*带双引号的时候，会把接收的所有参数当成一个字段处理 </li>
<li>将$@与$* 赋值给变量之后，结果跟不带引号是一样的！这是我们需要注意的地方，当$* 赋值给变量的时候还是跟不带引号的作用是一样的！</li>
</ol>
<h3 id="2-7-8-利用软链接实现同一个脚本不同功能"><a href="#2-7-8-利用软链接实现同一个脚本不同功能" class="headerlink" title="2.7.8  利用软链接实现同一个脚本不同功能"></a>2.7.8  利用软链接实现同一个脚本不同功能</h3><p><strong>范例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#cat test.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">#********************************************************************</span><br><span class="line">echo $0</span><br><span class="line">[root@centos8 ~]#ln -s test.sh a.sh</span><br><span class="line">[root@centos8 ~]#ln -s test.sh b.sh</span><br><span class="line">[root@centos8 ~]#./a.sh</span><br><span class="line">./a.sh</span><br><span class="line">[root@centos8 ~]#./b.sh</span><br><span class="line">./b.sh</span><br></pre></td></tr></table></figure>

<h3 id="2-7-9-退出状态码变量"><a href="#2-7-9-退出状态码变量" class="headerlink" title="2.7.9 退出状态码变量"></a>2.7.9 退出状态码变量</h3><p><strong>进程执行后，将使用变量 $? 保存状态码的相关数字，不同的值反应成功或失败，$?取值范例 0-255</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$?的值为0 #代表成功</span><br><span class="line">$?的值是1到255 #代表失败</span><br></pre></td></tr></table></figure>

<p><strong>范例：状态码为0</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# ll</span><br><span class="line">total 40</span><br><span class="line">drwxr-xr-x 2 root root 4096 Aug  6 07:29 ./</span><br><span class="line">drwxr-xr-x 3 root root 4096 Aug  6 02:41 ../</span><br><span class="line">-rw-r--r-- 1 root root  241 Aug  6 06:48 args.sh</span><br><span class="line">-rw-r--r-- 1 root root  192 Aug  6 02:40 bacup.sh</span><br><span class="line">-rw-r--r-- 1 root root  185 Aug  6 03:38 demo1.sh</span><br><span class="line">-rw-r--r-- 1 root root   85 Aug  6 07:26 f1.sh</span><br><span class="line">-rw-r--r-- 1 root root   41 Aug  6 07:29 file.sh</span><br><span class="line">-rwxr-xr-x 1 root root  208 Aug  6 01:42 hello.sh*</span><br><span class="line">-rwxr-xr-x 1 root root  285 Aug  6 07:20 rm.sh*</span><br><span class="line">-rwxr-xr-x 1 root root  284 Aug  6 07:01 rm.sh.bak*</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $?</span><br><span class="line">0</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p><strong>范例：状态码不是0</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# ls ajdksh</span><br><span class="line">ls: cannot access &#x27;ajdksh&#x27;: No such file or directory</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $?</span><br><span class="line">2</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p><strong>用户可以在脚本中使用以下命令自定义退出状态码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exit [n]</span><br></pre></td></tr></table></figure>

<p><strong>案例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# cat exit.sh </span><br><span class="line">#!/bin/bash</span><br><span class="line">echo -e `hostname`</span><br><span class="line"></span><br><span class="line">exit 200</span><br><span class="line"></span><br><span class="line">echo -e &#x27;success&#x27;</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br><span class="line">root@ubuntu200404:/data/scripts# bash exit.sh </span><br><span class="line">ubuntu200404</span><br><span class="line">exit.sh: line 4: exit: 200: numeric argument required</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<ul>
<li>脚本中一旦遇到exit命令，脚本会立即终止；终止退出状态取决于exit命令后面的数字</li>
<li>如果exit后面无数字,终止退出状态取决于exit命令前面命令执行结果</li>
<li>如果没有exit命令, 即未给脚本指定退出状态码，整个脚本的退出状态码取决于脚本中执行的最后一条命令的状态码</li>
</ul>
<h3 id="2-7-10-脚本安全和-set"><a href="#2-7-10-脚本安全和-set" class="headerlink" title="2.7.10 脚本安全和 set"></a>2.7.10 脚本安全和 set</h3><p><strong>set 命令：可以用来定制 shell 环境</strong><br>$- 变量<br>h：hashall，打开选项后，Shell 会将命令所在的路径hash下来，避免每次都要查询。通过set +h将h选<br>项关闭<br>i：interactive-comments，包含这个选项说明当前的 shell 是一个交互式的 shell。所谓的交互式shell,<br>在脚本中，i选项是关闭的<br>m：monitor，打开监控模式，就可以通过Job control来控制进程的停止、继续，后台或者前台执行等<br>B：braceexpand，大括号扩展<br>H：history，H选项打开，可以展开历史列表中的命令，可以通过!感叹号来完成，例如“!!”返回上最近的<br>一个历史命令，“!n”返回第 n 个历史命令</p>
<p><strong>set 命令实现脚本安全</strong><br>-u 在扩展一个没有设置的变量时，显示错误信息， 等同set -o nounset<br>-e 如果一个命令返回一个非0退出状态值(失败)就退出， 等同set -o errexit<br>-o option 显示，打开或者关闭选项<br>显示选项：set -o<br>打开选项：set -o 选项<br>关闭选项：set +o 选项<br>-x 当执行命令时，打印命令及其参数,类似 bash -x<br>范例：-e -u</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">#******************</span><br><span class="line">#filename:hello.sh</span><br><span class="line">#Data:2022-08-06</span><br><span class="line">#author:admin</span><br><span class="line">#******************</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">set -e -u</span><br><span class="line"></span><br><span class="line">#echo &quot;经典写法&quot;</span><br><span class="line">echo &quot;hello world!&quot;</span><br><span class="line"></span><br><span class="line">echo &#x27;******************&#x27;</span><br><span class="line"></span><br><span class="line"># 流行写法</span><br><span class="line">echo &#x27;hello world!&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="2-8-算术运算"><a href="#2-8-算术运算" class="headerlink" title="2.8 算术运算"></a>2.8 算术运算</h2><p>Shell允许在某些情况下对算术表达式进行求值，比如：let和declare 内置命令，(( ))复合命令和算术扩<br>展。求值以固定宽度的整数进行，不检查溢出，尽管除以0 被困并标记为错误。运算符及其优先级，关联性和值与C语言相同。以下运算符列表分组为等优先级运算符级别。级别按降序排列优先。<br><strong>注意：bash 只支持整数，不支持小数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">+ - addition, subtraction</span><br><span class="line">* / % multiplication, division, remainder, %表示取模，即取余数，示例：9%4=1，5%3=2</span><br><span class="line">i++ i-- variable post-increment and post-decrement</span><br><span class="line">++i --i variable pre-increment and pre-decrement</span><br><span class="line">= *= /= %= += -= &lt;&lt;= &gt;&gt;= &amp;= ^= |= assignment</span><br><span class="line">- + unary minus and plus</span><br><span class="line">! ~ logical and bitwise negation</span><br><span class="line">** exponentiation 乘方,即指数运算</span><br><span class="line">&lt;&lt; &gt;&gt; left and right bitwise shifts</span><br><span class="line">&lt;= &gt;= &lt; &gt; comparison</span><br><span class="line">== != equality and inequality</span><br><span class="line">&amp; bitwise AND</span><br><span class="line">| bitwise OR</span><br><span class="line">^ bitwise exclusive OR</span><br><span class="line">&amp;&amp; logical AND</span><br><span class="line">|| logical OR</span><br><span class="line">expr?expr:expr conditional operator</span><br><span class="line">expr1 , expr2 comma</span><br></pre></td></tr></table></figure>

<p><strong>乘法符号有些场景中需要转义</strong><br><strong>实现算术运算：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(1) let var=算术表达式</span><br><span class="line">(2) ((var=算术表达式)) 和上面等价</span><br><span class="line">(3) var=$[算术表达式]</span><br><span class="line">(4) var=$((算术表达式))</span><br><span class="line">(5) var=$(expr arg1 arg2 arg3 ...)</span><br><span class="line">(6) declare -i var = 数值</span><br><span class="line">(7) echo &#x27;算术表达式&#x27; | bc</span><br></pre></td></tr></table></figure>

<p><strong>内建的随机数生成器变量：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$RANDOM 取值范围：0-32767</span><br></pre></td></tr></table></figure>

<p><strong>范例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#生成 0 - 49 之间随机数</span><br><span class="line">echo $[$RANDOM%50]</span><br><span class="line">#随机字体颜色</span><br><span class="line">[root@centos8 ~]#echo -e &quot;\033[1;$[RANDOM%7+31]mhello\033[0m&quot;</span><br><span class="line">magedu</span><br></pre></td></tr></table></figure>

<h2 id="2-9-逻辑运算"><a href="#2-9-逻辑运算" class="headerlink" title="2.9 逻辑运算"></a>2.9 逻辑运算</h2><p><img src="/../image.assets/1659774970166.png" alt="1659774970166"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1,真</span><br><span class="line">0,假</span><br><span class="line">#注意,以上为二进制</span><br></pre></td></tr></table></figure>

<p><strong>与或非符号：&amp; | ！</strong></p>
<p><strong>异或：^</strong></p>
<p>**异或：^ **<br>异或的两个值，相同为假，不同为真。两个数字X,Y异或得到结果Z，Z再和任意两者之一X异或，将得出另一个值Y</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0 ^ 0 = 0</span><br><span class="line">0 ^ 1 = 1</span><br><span class="line">1 ^ 0 = 1</span><br><span class="line">1 ^ 1 = 0</span><br></pre></td></tr></table></figure>

<h2 id="2-10-条件测试命令"><a href="#2-10-条件测试命令" class="headerlink" title="2.10 条件测试命令"></a>2.10 条件测试命令</h2><p>条件测试：判断某需求是否满足，需要由测试机制来实现，专用的测试表达式需要由测试命令辅助完成<br>测试过程，实现评估布尔声明，以便用在条件性环境下进行执行<br>若真，则状态码变量 $? 返回0<br>若假，则状态码变量 $? 返回1<br>条件测试命令</p>
<ul>
<li>test EXPRESSIO</li>
<li>[ EXPRESSION ] #和test 等价，建议使用 [ ]</li>
<li>[[ EXPRESSION ]] 相关于增强版的 [ ], 支持[]的用法,且支持扩展正则表达式和通配</li>
</ul>
<p><strong>注意：EXPRESSION前后必须有空白字符</strong></p>
<p><strong>帮助：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# type [</span><br><span class="line">[ is a shell builtin</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br><span class="line"></span><br><span class="line">root@ubuntu200404:/data/scripts# help test</span><br><span class="line">test: test [expr]</span><br><span class="line">    Evaluate conditional expression.</span><br><span class="line">    </span><br><span class="line">    Exits with a status of 0 (true) or 1 (false) depending on</span><br><span class="line">    the evaluation of EXPR.  Expressions may be unary or binary.  Unary</span><br><span class="line">    expressions are often used to examine the status of a file.  There</span><br><span class="line">    are string operators and numeric comparison operators as well.</span><br><span class="line">    </span><br><span class="line">    The behavior of test depends on the number of arguments.  Read the</span><br><span class="line">    bash manual page for the complete specification.</span><br><span class="line">    </span><br><span class="line">    File operators:</span><br><span class="line">    </span><br><span class="line">      -a FILE        True if file exists.</span><br><span class="line">      -b FILE        True if file is block special.</span><br><span class="line">      -c FILE        True if file is character special.</span><br><span class="line">      -d FILE        True if file is a directory.</span><br><span class="line">      -e FILE        True if file exists.</span><br><span class="line">      -f FILE        True if file exists and is a regular file.</span><br><span class="line">      -g FILE        True if file is set-group-id.</span><br><span class="line">      -h FILE        True if file is a symbolic link.</span><br><span class="line">      -L FILE        True if file is a symbolic link.</span><br><span class="line">      -k FILE        True if file has its `sticky&#x27; bit set.</span><br><span class="line">      -p FILE        True if file is a named pipe.</span><br><span class="line">      -r FILE        True if file is readable by you.</span><br><span class="line">      -s FILE        True if file exists and is not empty.</span><br><span class="line">      -S FILE        True if file is a socket.</span><br><span class="line">      -t FD          True if FD is opened on a terminal.</span><br><span class="line">      -u FILE        True if the file is set-user-id.</span><br><span class="line">      -w FILE        True if the file is writable by you.</span><br><span class="line">      -x FILE        True if the file is executable by you.</span><br><span class="line">      -O FILE        True if the file is effectively owned by you.</span><br><span class="line">      -G FILE        True if the file is effectively owned by your group.</span><br><span class="line">      -N FILE        True if the file has been modified since it was last read.</span><br><span class="line">    </span><br><span class="line">      FILE1 -nt FILE2  True if file1 is newer than file2 (according to</span><br><span class="line">                       modification date).</span><br><span class="line">    </span><br><span class="line">      FILE1 -ot FILE2  True if file1 is older than file2.</span><br><span class="line">    </span><br><span class="line">      FILE1 -ef FILE2  True if file1 is a hard link to file2.</span><br><span class="line">    </span><br><span class="line">    All file operators except -h and -L are acting on the target of a symbolic</span><br><span class="line">    link, not on the symlink itself, if FILE is a symbolic link.</span><br><span class="line">    </span><br><span class="line">    String operators:</span><br><span class="line">    </span><br><span class="line">      -z STRING      True if string is empty.</span><br><span class="line">    </span><br><span class="line">      -n STRING</span><br><span class="line">         STRING      True if string is not empty.</span><br><span class="line">    </span><br><span class="line">      STRING1 = STRING2</span><br><span class="line">                     True if the strings are equal.</span><br><span class="line">      STRING1 != STRING2</span><br><span class="line">                     True if the strings are not equal.</span><br><span class="line">      STRING1 &lt; STRING2</span><br><span class="line">                     True if STRING1 sorts before STRING2 lexicographically.</span><br><span class="line">      STRING1 &gt; STRING2</span><br><span class="line">                     True if STRING1 sorts after STRING2 lexicographically.</span><br><span class="line">    </span><br><span class="line">    Other operators:</span><br><span class="line">    </span><br><span class="line">      -o OPTION      True if the shell option OPTION is enabled.</span><br><span class="line">      -v VAR         True if the shell variable VAR is set.</span><br><span class="line">      -R VAR         True if the shell variable VAR is set and is a name</span><br><span class="line">                     reference.</span><br><span class="line">      ! EXPR         True if expr is false.</span><br><span class="line">      EXPR1 -a EXPR2 True if both expr1 AND expr2 are true.</span><br><span class="line">      EXPR1 -o EXPR2 True if either expr1 OR expr2 is true.</span><br><span class="line">    </span><br><span class="line">      arg1 OP arg2   Arithmetic tests.  OP is one of -eq, -ne,</span><br><span class="line">                     -lt, -le, -gt, or -ge.</span><br><span class="line">    </span><br><span class="line">    Arithmetic binary operators return true if ARG1 is equal, not-equal,</span><br><span class="line">    less-than, less-than-or-equal, greater-than, or greater-than-or-equal</span><br><span class="line">    than ARG2.</span><br><span class="line">    </span><br><span class="line">    See the bash manual page bash(1) for the handling of parameters (i.e.</span><br><span class="line">    missing parameters).</span><br><span class="line">    </span><br><span class="line">    Exit Status:</span><br><span class="line">    Returns success if EXPR evaluates to true; fails if EXPR evaluates to</span><br><span class="line">    false or an invalid argument is given.</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-10-1-变量测试"><a href="#2-10-1-变量测试" class="headerlink" title="2.10.1 变量测试"></a>2.10.1 变量测试</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#判断 NAME 变量是否定义</span><br><span class="line">[ -v NAME ]</span><br></pre></td></tr></table></figure>

<p><strong>范例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# NAME=&#x27;tom&#x27;</span><br><span class="line">root@ubuntu200404:/data/scripts# [ -v NAME ]</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $?</span><br><span class="line">0</span><br><span class="line">root@ubuntu200404:/data/scripts# [ -v AGE ]</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $?</span><br><span class="line">1</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<h3 id="2-10-2-数值测试"><a href="#2-10-2-数值测试" class="headerlink" title="2.10.2 数值测试"></a>2.10.2 数值测试</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-eq 是否等于</span><br><span class="line">-ne 是否不等于</span><br><span class="line">-gt 是否大于</span><br><span class="line">-ge 是否大于等于</span><br><span class="line">-lt 是否小于</span><br><span class="line">-le 是否小于等于</span><br></pre></td></tr></table></figure>

<p><strong>范例：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#i=10</span><br><span class="line">[root@centos8 ~]#j=8</span><br><span class="line">[root@centos8 ~]#[ $i -lt $j ]</span><br><span class="line">[root@centos8 ~]#echo $?</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h3 id="2-10-3-算术表达式比较"><a href="#2-10-3-算术表达式比较" class="headerlink" title="2.10.3 算术表达式比较"></a>2.10.3 算术表达式比较</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">== 相等</span><br><span class="line">!= 不相等</span><br><span class="line">&lt;=</span><br><span class="line">&gt;=</span><br><span class="line">&lt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>

<p>范例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#x=10;y=10;(( x == y ));echo $?</span><br><span class="line">0</span><br><span class="line">[root@centos8 ~]#x=10;y=20;(( x == y ));echo $?</span><br><span class="line">1</span><br><span class="line">[root@centos8 ~]#x=10;y=20;(( x != y ));echo $?</span><br><span class="line">0</span><br><span class="line">[root@centos8 ~]#x=10;y=10;(( x != y ));echo $?</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h3 id="2-10-4-字符窜测试"><a href="#2-10-4-字符窜测试" class="headerlink" title="2.10.4 字符窜测试"></a>2.10.4 字符窜测试</h3><p><strong>test和 [ ] 字符串测试用法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-z STRING 字符串是否为空，没定义或空为真，不空为假，</span><br><span class="line">-n STRING 字符串是否不空，不空为真，空为假</span><br><span class="line">STRING 同上</span><br><span class="line">STRING1 = STRING2 是否等于，注意 = 前后有空格</span><br><span class="line">STRING1 != STRING2 是否不等于</span><br><span class="line">&gt; ascii码是否大于ascii码</span><br><span class="line">&lt; 是否小于</span><br></pre></td></tr></table></figure>

<p><strong>[[]] 字符串测试用法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[[ expression ]] 用法</span><br><span class="line">== 左侧字符串是否和右侧的PATTERN相同</span><br><span class="line">注意:此表达式用于[[ ]]中，PATTERN为通配符</span><br><span class="line">=~ 左侧字符串是否能够被右侧的正则表达式的PATTERN所匹配</span><br><span class="line">注意: 此表达式用于[[ ]]中为扩展的正则表达式</span><br></pre></td></tr></table></figure>

<p><strong>建议：当使用正则表达式或通配符使用[[ ]]，其它情况一般使用 [ ]</strong>  </p>
<hr>
<p><strong>范例：使用 [ ]</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#unset str</span><br><span class="line">[root@centos8 ~]#[ -z &quot;$str&quot; ]</span><br><span class="line">[root@centos8 ~]#echo $?</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<p><strong>范例：在比较字符串时，建议变量放在“ ”中</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#[ &quot;$NAME&quot; ]</span><br><span class="line">[root@centos8 ~]#NAME=&quot;I love linux&quot;</span><br><span class="line">[root@centos8 ~]#[ $NAME ]</span><br><span class="line">-bash: [: love: binary operator expected</span><br><span class="line">[root@centos8 ~]#[ &quot;$NAME&quot; ]</span><br><span class="line">[root@centos8 ~]#echo $?</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<p><strong>[[]]中如果不想使用通配符*,只想表达*本身,可以用” “引起来</strong>  </p>
<hr>
<p><em><em>#[[]]中如果不想使用通配符</em>,只想表达*本身,也可以使用转义符*</em></p>
<h3 id="2-10-5-文件测试"><a href="#2-10-5-文件测试" class="headerlink" title="2.10.5 文件测试"></a>2.10.5 文件测试</h3><p><strong>存在性测试</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-a FILE：同 -e</span><br><span class="line">-e FILE: 文件存在性测试，存在为真，否则为假</span><br><span class="line">-b FILE：是否存在且为块设备文件</span><br><span class="line">-c FILE：是否存在且为字符设备文件</span><br><span class="line">-d FILE：是否存在且为目录文件</span><br><span class="line">-f FILE：是否存在且为普通文件</span><br><span class="line">-h FILE 或 -L FILE：存在且为符号链接文件</span><br><span class="line">-p FILE：是否存在且为命名管道文件</span><br><span class="line">-S FILE：是否存在且为套接字文件</span><br></pre></td></tr></table></figure>

<p><strong>案例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# [ -e /data/scripts/rm.sh ]</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $?</span><br><span class="line">0</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p><strong>文件权限测试</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-r FILE：是否存在且可读</span><br><span class="line">-w FILE: 是否存在且可写</span><br><span class="line">-x FILE: 是否存在且可执行</span><br><span class="line">-u FILE：是否存在且拥有suid权限</span><br><span class="line">-g FILE：是否存在且拥有sgid权限</span><br><span class="line">-k FILE：是否存在且拥有sticky权限</span><br></pre></td></tr></table></figure>

<p><strong>注意：最终结果由用户对文件的实际权限决定，而非文件属性决定</strong>  </p>
<hr>
<p><strong>范例:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# [ -w /data/scripts/rm.sh ]</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $?</span><br><span class="line">0</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<p><strong>文件属性测试</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-s FILE #是否存在且非空</span><br><span class="line">-t fd #fd 文件描述符是否在某终端已经打开</span><br><span class="line">-N FILE #文件自从上一次被读取之后是否被修改过</span><br><span class="line">-O FILE #当前有效用户是否为文件属主</span><br><span class="line">-G FILE #当前有效用户是否为文件属组</span><br><span class="line">FILE1 -ef FILE2 #FILE1是否是FILE2的硬链接</span><br><span class="line">FILE1 -nt FILE2 #FILE1是否新于FILE2（mtime）</span><br><span class="line">FILE1 -ot FILE2 #FILE1是否旧于FILE2</span><br></pre></td></tr></table></figure>

<p><strong>案例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data/scripts# [ -s /data/scripts/rm.sh ]</span><br><span class="line">root@ubuntu200404:/data/scripts# echo $?</span><br><span class="line">0</span><br><span class="line">root@ubuntu200404:/data/scripts# </span><br></pre></td></tr></table></figure>

<h2 id="2-11-关于（）和"><a href="#2-11-关于（）和" class="headerlink" title="2.11 关于（）和{}"></a>2.11 关于（）和{}</h2><p><strong>（CMD1;CMD2;…）和 { CMD1;CMD2;…; } 都可以将多个命令组合在一起，批量执行</strong>**</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">( list ) 会开启子shell,并且list中变量赋值及内部命令执行后,将不再影响后续的环境</span><br><span class="line">帮助参看:man bash 搜索(list)</span><br><span class="line">&#123; list; &#125; 不会启子shell, 在当前shell中运行,会影响当前shell环境</span><br><span class="line">帮助参看:man bash 搜索&#123; list; &#125;</span><br><span class="line"></span><br><span class="line">( list ) 会开启子shell,并且list中变量赋值及内部命令执行后,将不再影响后续的环境</span><br><span class="line">帮助参看:man bash 搜索(list)</span><br><span class="line">&#123; list; &#125; 不会启子shell, 在当前shell中运行,会影响当前shell环境</span><br><span class="line">帮助参看:man bash 搜索&#123; list; &#125;</span><br><span class="line"></span><br><span class="line">#（）会开启子shell</span><br><span class="line">[root@centos8 ~]#echo $BASHPID</span><br><span class="line">1920</span><br><span class="line">[root@centos8 ~]#( echo $BASHPID;sleep 100)</span><br><span class="line">1979</span><br><span class="line">[root@centos8 ~]#pstree -p</span><br><span class="line">├─sshd(719)───sshd(1906)───sshd(1919)─┬─bash(1920)───bash(1979)───sleep(1980)</span><br><span class="line">#&#123; &#125; 不会开启子shell</span><br><span class="line">[root@centos8 ~]#echo $BASHPID</span><br><span class="line">1920</span><br></pre></td></tr></table></figure>

<h2 id="2-12-组合测试"><a href="#2-12-组合测试" class="headerlink" title="2.12 组合测试"></a>2.12 组合测试</h2><h3 id="2-12-1-第一种方式"><a href="#2-12-1-第一种方式" class="headerlink" title="2.12.1 第一种方式"></a>2.12.1 第一种方式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ EXPRESSION1 -a EXPRESSION2 ] #并且，EXPRESSION1和EXPRESSION2都是真，结果才为真</span><br><span class="line">[ EXPRESSION1 -o EXPRESSION2 ] #或者，EXPRESSION1和EXPRESSION2只要有一个真，结果就为</span><br><span class="line">真</span><br><span class="line">[ ! EXPRESSION ] #取反</span><br></pre></td></tr></table></figure>

<p><strong>说明： -a 和 -o 需要使用测试命令进行，[[ ]] 不支持</strong></p>
<h3 id="2-12-2-第二种方式"><a href="#2-12-2-第二种方式" class="headerlink" title="2.12.2 第二种方式"></a>2.12.2 第二种方式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">COMMAND1 &amp;&amp; COMMAND2 #并且，短路与，代表条件性的AND THEN</span><br><span class="line">如果COMMAND1 成功,将执行COMMAND2,否则,将不执行COMMAND2</span><br><span class="line">COMMAND1 || COMMAND2 #或者，短路或，代表条件性的OR ELSE</span><br><span class="line">如果COMMAND1 成功,将不执行COMMAND2,否则,将执行COMMAND2</span><br><span class="line">! COMMAND #非,取反</span><br></pre></td></tr></table></figure>

<p><strong>如果&amp;&amp; 和 || 混合使用，&amp;&amp; 要在前，|| 放在后</strong>  </p>
<hr>
<p><strong>练习</strong><br>1、编写脚本 argsnum.sh，接受一个文件路径作为参数；如果参数个数小于1，则提示用户“至少应该给一个参数”，并立即退出；如果参数个数不小于1，则显示第一个参数所指向的文件中的空白行数<br>2、编写脚本 hostping.sh，接受一个主机的IPv4地址做为参数，测试是否可连通。如果能ping通，则提示用户“该IP地址可访问”；如果不可ping通，则提示用户“该IP地址不可访问”<br>3、编写脚本 checkdisk.sh，检查磁盘分区空间和inode使用率，如果超过80%，就发广播警告空间将满<br>4、编写脚本 per.sh，判断当前用户对指定参数文件，是否不可读并且不可写<br>5、编写脚本 excute.sh ，判断参数文件是否为sh后缀的普通文件，如果是，添加所有人可执行权限，否则提示用户非脚本文件<br>6、编写脚本 nologin.sh和 login.sh，实现禁止和允许普通用户登录系统</p>
<h2 id="2-13-使用read命令来接受输入"><a href="#2-13-使用read命令来接受输入" class="headerlink" title="2.13 使用read命令来接受输入"></a>2.13 使用read命令来接受输入</h2><p>使用read来把输入值分配给一个或多个shell变量，read从标准输入中读取值，给每个单词分配一个变量，所有剩余单词都被分配给最后一个变量，如果变量名没有指定，默认标准输入的值赋值给系统内置变量REPLY<br>格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read [options] [name ...]</span><br></pre></td></tr></table></figure>

<p><strong>常用选项：</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-p 指定要显示的提示</span><br><span class="line">-s 静默输入，一般用于密码</span><br><span class="line">-n N 指定输入的字符长度N</span><br><span class="line">-d &#x27;字符&#x27; 输入结束符</span><br><span class="line">-t N TIMEOUT为N秒</span><br></pre></td></tr></table></figure>

<p><strong>范例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky ~]# read -p &#x27;请输入任意内容&#x27; NAME</span><br><span class="line">请输入任意内容yuan</span><br><span class="line">[root@rocky ~]# echo $&#123;NAME&#125;</span><br><span class="line">yuan</span><br><span class="line">[root@rocky ~]# </span><br></pre></td></tr></table></figure>

<h1 id="3-条件选择if"><a href="#3-条件选择if" class="headerlink" title="3  条件选择if"></a>3  条件选择if</h1><p><strong>格式：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if COMMANDS; then COMMANDS; [ elif COMMANDS; then COMMANDS; ]... [ else</span><br><span class="line">COMMANDS; ] fi</span><br></pre></td></tr></table></figure>

<p><strong>单分支：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if 判断条件;then</span><br><span class="line">条件为真的分支代码</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p><strong>双分支：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if 判断条件; then</span><br><span class="line">条件为真的分支代码</span><br><span class="line">else</span><br><span class="line">条件为假的分支代码</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p><strong>多分支：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">if 判断条件1; then</span><br><span class="line">条件1为真的分支代码</span><br><span class="line">elif 判断条件2; then</span><br><span class="line">条件2为真的分支代码</span><br><span class="line">elif 判断条件3; then</span><br><span class="line">条件3为真的分支代码</span><br><span class="line">...</span><br><span class="line">else</span><br><span class="line">以上条件都为假的分支代码</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h1 id="4-循环"><a href="#4-循环" class="headerlink" title="4 循环"></a>4 循环</h1><h2 id="4-1-for循环"><a href="#4-1-for循环" class="headerlink" title="4.1 for循环"></a>4.1 for循环</h2><p><strong>帮助：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help for</span><br></pre></td></tr></table></figure>

<p><strong>格式：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">for NAME [in WORDS ... ] ; do COMMANDS; done</span><br><span class="line">#方式1</span><br><span class="line">for 变量名 in 列表;do</span><br><span class="line">循环体</span><br><span class="line">done</span><br><span class="line">#方式2</span><br><span class="line">for 变量名 in 列表</span><br><span class="line">do</span><br><span class="line">循环体</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p><strong>执行机制：</strong></p>
<ul>
<li>依次将列表中的元素赋值给“变量名”; 每次赋值后即执行一次循环体; 直到列表中的元素耗尽，循环结束</li>
<li>如果省略 [in WORDS … ] ，此时使用位置参数变量 in “$@”</li>
</ul>
<p><strong>for 循环列表生成方式：</strong></p>
<ul>
<li>直接给出列表</li>
<li>整数列表：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;start..end&#125;</span><br><span class="line">$(seq [start [step]] end)</span><br></pre></td></tr></table></figure>

<ul>
<li>返回列表的命令</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(COMMAND)</span><br></pre></td></tr></table></figure>

<ul>
<li>使用glob，如：*.sh*</li>
<li>*变量引用，如：$@，$*，$#</li>
</ul>
<p><strong>范例：计算1+···+100的值</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#sum=0;for i in &#123;1..100&#125;;do let sum+=i;done ;echo sum=$sum</span><br><span class="line">sum=5050</span><br><span class="line">[root@centos8 ~]#seq -s+ 100|bc5050</span><br><span class="line">5050</span><br><span class="line">[root@centos8 ~]#echo &#123;1..100&#125;|tr &#x27; &#x27; +|bc</span><br><span class="line">5050</span><br><span class="line">[root@centos8 ~]#seq 100|paste -sd +|bc</span><br><span class="line">5050</span><br></pre></td></tr></table></figure>

<h2 id="4-2-while循环"><a href="#4-2-while循环" class="headerlink" title="4.2 while循环"></a>4.2 while循环</h2><p><strong>格式</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while COMMANDS; do COMMANDS; done</span><br><span class="line">while CONDITION; do</span><br><span class="line">循环体</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p><strong>扩展:nc命令</strong></p>
<p>nc命令 全称netcat，用于设置路由器。它能通过 TCP 和 UDP 在网络中读写数据。通过与其他工具结合和重定向，你可以在脚本中以多种方式使用它。使用 netcat 命令所能完成的事情令人惊讶。</p>
<p><strong>选项</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-g&lt;网关&gt; 设置路由器跃程通信网关，最多可设置8个。</span><br><span class="line">-G&lt;指向器数目&gt; 设置来源路由指向器，其数值为4的倍数。</span><br><span class="line">-h 在线帮助。</span><br><span class="line">-i&lt;延迟秒数&gt; 设置时间间隔，以便传送信息及扫描通信端口。</span><br><span class="line">-l 使用监听模式，管控传入的资料。</span><br><span class="line">-n 直接使用IP地址，而不通过域名服务器。</span><br><span class="line">-o&lt;输出文件&gt; 指定文件名称，把往来传输的数据以16进制字码倾倒成该文件保存。</span><br><span class="line">-p&lt;通信端口&gt; 设置本地主机使用的通信端口。</span><br><span class="line">-r 乱数指定本地与远端主机的通信端口。</span><br><span class="line">-s&lt;来源位址&gt; 设置本地主机送出数据包的IP地址。</span><br><span class="line">-u 使用UDP传输协议。</span><br><span class="line">-v 显示指令执行过程。</span><br><span class="line">-w&lt;超时秒数&gt; 设置等待连线的时间。</span><br><span class="line">-z 使用0输入/输出模式，只在扫描通信端口时使用。</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">TCP端口扫描</span></span><br><span class="line">[root@rocky ~]# nc -zv 192.168.179.129 80</span><br><span class="line">Ncat: Version 7.70 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Connected to 192.168.179.129:80.</span><br><span class="line">Ncat: 0 bytes sent, 0 bytes received in 0.01 seconds.</span><br><span class="line">[root@rocky ~]# </span><br></pre></td></tr></table></figure>

<p><strong>范例:写一个扫描某个主机端口的状态的脚本</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">变量</span></span><br><span class="line">i=1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">主机IP</span></span><br><span class="line">host=192.168.179.138</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">清空文件内容</span></span><br><span class="line">cat /dev/null &gt;port.TXT</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">循环端口1-100</span></span><br><span class="line">while [ $i -le 100 ];do</span><br><span class="line"><span class="meta prompt_">	# </span><span class="language-bash">扫描端口并将信息放入垃圾箱</span></span><br><span class="line">    if nc -z $&#123;host&#125; $&#123;i&#125; &amp;&gt; /dev/null;then</span><br><span class="line">    # 屏幕打印IP+port,输出重定向到port.TXT</span><br><span class="line">        echo $&#123;host&#125;:$&#123;i&#125; | tee -a port.TXT</span><br><span class="line">    fi</span><br><span class="line">    # i++</span><br><span class="line">    let i++</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h1 id="5-其他脚本相关工具"><a href="#5-其他脚本相关工具" class="headerlink" title="5 其他脚本相关工具"></a>5 其他脚本相关工具</h1><h2 id="5-1-trap命令"><a href="#5-1-trap命令" class="headerlink" title="5.1 trap命令"></a>5.1 trap命令</h2><p>trap命令可以捕捉信号，修改信号原有的功能，实现自定义功能</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 查看信号trap -l 或者kill -l</span><br><span class="line">root@ubuntu200404-1:/data/scripts# kill -l</span><br><span class="line"> 1) SIGHUP	 2) SIGINT	 3) SIGQUIT	 4) SIGILL	 5) SIGTRAP</span><br><span class="line"> 6) SIGABRT	 7) SIGBUS	 8) SIGFPE	 9) SIGKILL	10) SIGUSR1</span><br><span class="line">11) SIGSEGV	12) SIGUSR2	13) SIGPIPE	14) SIGALRM	15) SIGTERM</span><br><span class="line">16) SIGSTKFLT	17) SIGCHLD	18) SIGCONT	19) SIGSTOP	20) SIGTSTP</span><br><span class="line">21) SIGTTIN	22) SIGTTOU	23) SIGURG	24) SIGXCPU	25) SIGXFSZ</span><br><span class="line">26) SIGVTALRM	27) SIGPROF	28) SIGWINCH	29) SIGIO	30) SIGPWR</span><br><span class="line">31) SIGSYS	34) SIGRTMIN	35) SIGRTMIN+1	36) SIGRTMIN+2	37) SIGRTMIN+3</span><br><span class="line">38) SIGRTMIN+4	39) SIGRTMIN+5	40) SIGRTMIN+6	41) SIGRTMIN+7	42) SIGRTMIN+8</span><br><span class="line">43) SIGRTMIN+9	44) SIGRTMIN+10	45) SIGRTMIN+11	46) SIGRTMIN+12	47) SIGRTMIN+13</span><br><span class="line">48) SIGRTMIN+14	49) SIGRTMIN+15	50) SIGRTMAX-14	51) SIGRTMAX-13	52) SIGRTMAX-12</span><br><span class="line">53) SIGRTMAX-11	54) SIGRTMAX-10	55) SIGRTMAX-9	56) SIGRTMAX-8	57) SIGRTMAX-7</span><br><span class="line">58) SIGRTMAX-6	59) SIGRTMAX-5	60) SIGRTMAX-4	61) SIGRTMAX-3	62) SIGRTMAX-2</span><br><span class="line">63) SIGRTMAX-1	64) SIGRTMAX	</span><br><span class="line">root@ubuntu200404-1:/data/scripts#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 进程收到系统发出的制定信号后，将执行自定义指令，而不会执原操作</span><br><span class="line">trap &#x27;触发指令&#x27; 信号</span><br><span class="line"></span><br><span class="line"># 忽略信号的操作</span><br><span class="line">trap &#x27;&#x27; 信号</span><br><span class="line"></span><br><span class="line"># 恢复原信号的操作</span><br><span class="line">trap &#x27;-&#x27; 信号</span><br><span class="line"></span><br><span class="line"># 列出自定义的操作</span><br><span class="line">trap -p</span><br><span class="line"></span><br><span class="line"># 当脚本退出时，执行finish函数</span><br><span class="line">trap finish exit</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line"># 打印press ctrl+c or ctrl+\   replace int quit</span><br><span class="line">trap &quot;echo &#x27;press ctrl+c or ctrl+\ &#x27;&quot; 2 3</span><br><span class="line"></span><br><span class="line"># 列出 自定义的操作    </span><br><span class="line">trap -p</span><br><span class="line"></span><br><span class="line"># 循环并打印1-10</span><br><span class="line"># 打印1-10键盘按ctrl+c打印press ctrl+c or ctrl</span><br><span class="line">for ((i=1;i&lt;=10;i++))</span><br><span class="line">do</span><br><span class="line">	sleep 1</span><br><span class="line">	echo $&#123;i&#125;</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"># 忽略2 3信号操作</span><br><span class="line">trap &#x27;&#x27; 2 3</span><br><span class="line"></span><br><span class="line"># 打印出自定义操作</span><br><span class="line">trap -p</span><br><span class="line"></span><br><span class="line"># 打印11-20</span><br><span class="line"># 打印11-20的时候键盘按ctrl+c没有任何操作</span><br><span class="line">for((i=11;i&lt;=20;i++))</span><br><span class="line">do</span><br><span class="line">	sleep 1</span><br><span class="line">	echo $&#123;i&#125;</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"># 恢复原信号操作</span><br><span class="line">trap &#x27;-&#x27; int</span><br><span class="line"></span><br><span class="line"># 列出信号操作</span><br><span class="line">trap -p</span><br><span class="line"></span><br><span class="line"># 打印21-30键盘按ctrl+c 退出</span><br><span class="line">for((i=21;i&lt;=30;i++))</span><br><span class="line">do</span><br><span class="line">        sleep 1</span><br><span class="line">        echo $&#123;i&#125;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">finsh()&#123;</span><br><span class="line">	echo `date +%F-%T`-finsh | tee -a /data/finsh.log</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"># 捕捉到退出执行finsh   trap或者exit</span><br><span class="line">trap finsh exit</span><br><span class="line"></span><br><span class="line">while true;do</span><br><span class="line">	echo running</span><br><span class="line">	sleep 1</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p><strong>创建临时文件</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># mktemp testXXXX</span><br><span class="line">root@ubuntu200404-1:/data/scripts# mktemp testXXXXXX.log</span><br><span class="line">testdnlqM9.log</span><br><span class="line">root@ubuntu200404-1:/data/scripts# </span><br><span class="line"></span><br><span class="line"># 创建临时目录</span><br><span class="line">root@ubuntu200404-1:/data/scripts# mktemp -d testXXX</span><br><span class="line">testGio</span><br><span class="line">root@ubuntu200404-1:/data/scripts#</span><br></pre></td></tr></table></figure>

<h2 id="5-2-except实现自动化的非交互操作"><a href="#5-2-except实现自动化的非交互操作" class="headerlink" title="5. 2 except实现自动化的非交互操作"></a>5. 2 except实现自动化的非交互操作</h2><p>expect 是由Don Libes基于 Tcl（ Tool Command Language ）语言开发的，主要应用于自动化交互式<br>操作的场景，借助 expect 处理交互的命令，可以将交互过程如：ssh登录，ftp登录等写在一个脚本<br>上，使之自动化完成。尤其适用于需要对多台服务器执行相同操作的环境中，可以大大提高系统管理人<br>员的工作效率。</p>
<p><strong>expect语法</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expect [选项] [ -c cmds ] [ [ -[f|b] ] cmdfile ] [ args ]</span><br></pre></td></tr></table></figure>

<p><strong>常见选项</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-c：从命令行执行expect脚本，默认expect是交互地执行的</span><br><span class="line">-d：可以调试信息	</span><br></pre></td></tr></table></figure>

<p><strong>expect中相关命令</strong></p>
<ul>
<li>spawn	启动新的进程</li>
<li>expect    从进程接收字符串</li>
<li>send 用于向进程发送字符串</li>
<li>interact 允许用户交互</li>
<li>exp_continue 匹配多个字符串在执行动作后加此命令</li>
</ul>
<p><strong>范例1:自动登录</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 创建文件</span><br><span class="line">vim filename</span><br><span class="line"></span><br><span class="line"># 脚本内容</span><br><span class="line">#!/usr/bin/expect</span><br><span class="line"></span><br><span class="line"># 启动新的进程</span><br><span class="line">spawn ssh 192.168.179.138</span><br><span class="line"># 从进程接收字符串</span><br><span class="line">expect &#123;</span><br><span class="line">	# 匹配到yse/no，输入yes</span><br><span class="line">	&quot;yes/no&quot; &#123;send &quot;yes\n&quot;;exp_continue &#125;</span><br><span class="line">	&quot;password&quot; &#123; send &quot;123456\n&quot; &#125;</span><br><span class="line">&#125;</span><br><span class="line"># 允许用户交互</span><br><span class="line">interact</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 添加可执行权限</span><br><span class="line">chmod +x filename</span><br><span class="line"># 执行</span><br><span class="line">./filename</span><br></pre></td></tr></table></figure>

<p><strong>扩展：scp命令</strong></p>
<p><strong>语法</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp 选项 参数</span><br></pre></td></tr></table></figure>

<p><strong>选项</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-1：使用ssh协议版本1；</span><br><span class="line">-2：使用ssh协议版本2；</span><br><span class="line">-4：使用ipv4；</span><br><span class="line">-6：使用ipv6；</span><br><span class="line">-B：以批处理模式运行；</span><br><span class="line">-C：使用压缩；</span><br><span class="line">-F：指定ssh配置文件；</span><br><span class="line">-i：identity_file 从指定文件中读取传输时使用的密钥文件（例如亚马逊云pem），此参数直接传递给ssh；</span><br><span class="line">-l：指定宽带限制；</span><br><span class="line">-o：指定使用的ssh选项；</span><br><span class="line">-P：指定远程主机的端口号；</span><br><span class="line">-p：保留文件的最后修改时间，最后访问时间和权限模式；</span><br><span class="line">-q：不显示复制进度；</span><br><span class="line">-r：以递归方式复制。</span><br></pre></td></tr></table></figure>

<p><strong>实例</strong><br>从远程复制到本地的scp命令与上面的命令雷同，只要将从本地复制到远程的命令后面2个参数互换顺序就行了。</p>
<p><strong>从远程机器复制文件到本地目录</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp root@10.10.10.10:/opt/soft/nginx-0.5.38.tar.gz /opt/soft/</span><br></pre></td></tr></table></figure>
<p>从10.10.10.10机器上的&#x2F;opt&#x2F;soft&#x2F;的目录中下载nginx-0.5.38.tar.gz 文件到本地&#x2F;opt&#x2F;soft&#x2F;目录中。</p>
<p><strong>从远程机器复制目录到本地</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r root@10.10.10.10:/opt/soft/mongodb /opt/soft/</span><br></pre></td></tr></table></figure>
<p>从10.10.10.10机器上的&#x2F;opt&#x2F;soft&#x2F;中下载mongodb目录到本地的&#x2F;opt&#x2F;soft&#x2F;目录来。</p>
<p><strong>上传本地文件到远程机器指定目录</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp /opt/soft/nginx-0.5.38.tar.gz root@10.10.10.10:/opt/soft/scptest</span><br><span class="line"># 指定端口 2222</span><br><span class="line">scp -rp -P 2222 /opt/soft/nginx-0.5.38.tar.gz root@10.10.10.10:/opt/soft/scptest</span><br></pre></td></tr></table></figure>
<p>复制本地&#x2F;opt&#x2F;soft&#x2F;目录下的文件nginx-0.5.38.tar.gz到远程机器10.10.10.10的opt&#x2F;soft&#x2F;scptest目录。</p>
<p><strong>上传本地目录到远程机器指定目录</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r /opt/soft/mongodb root@10.10.10.10:/opt/soft/scptest</span><br></pre></td></tr></table></figure>
<p>上传本地目录&#x2F;opt&#x2F;soft&#x2F;mongodb到远程机器10.10.10.10上&#x2F;opt&#x2F;soft&#x2F;scptest的目录中去。</p>
<p><strong>范例2:非交互式复制文件</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/expect</span><br><span class="line"></span><br><span class="line"># 开启新的进程,复制当前主机下的/root/hello.sh到远程主机</span><br><span class="line">spawn scp /root/hello.sh root@192.168.179.129:/root</span><br><span class="line"></span><br><span class="line">expect &#123;</span><br><span class="line">	# 匹配到yes/no，输入yes</span><br><span class="line">	&quot;yes/no&quot; &#123; send &quot;yes\n&quot;;exp_continue&#125;</span><br><span class="line">	&quot;password&quot; &#123; send &quot;123456\n&quot;&#125;	</span><br><span class="line">&#125;</span><br><span class="line">expect eof</span><br></pre></td></tr></table></figure>

<p><strong>范例3:变量</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/expect</span><br><span class="line"></span><br><span class="line"># 添加变量</span><br><span class="line">set ip 192.168.179.138</span><br><span class="line">set user root</span><br><span class="line">set passwd 123456</span><br><span class="line">set timeout 10</span><br><span class="line"></span><br><span class="line"># 启动新的进程</span><br><span class="line">spawn ssh $&#123;user&#125;@$&#123;ip&#125;</span><br><span class="line"></span><br><span class="line">expect &#123;</span><br><span class="line">	&quot;yes/no&quot; &#123; send &quot;yes\n&quot;;exp_continue&#125;</span><br><span class="line">	&quot;password&quot; &#123; send &quot;$passwd\n&quot; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 允许交互式操作</span><br><span class="line">interact</span><br></pre></td></tr></table></figure>

<p><strong>范例4:位置参数</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/expect</span><br><span class="line"></span><br><span class="line"># 添加变量</span><br><span class="line">set ip [lindex $argv 0]</span><br><span class="line">set user [lindex $argv 1]</span><br><span class="line">set passwd [lindex $argv 2]</span><br><span class="line">set timeout 10</span><br><span class="line"></span><br><span class="line"># 启动新的进程</span><br><span class="line">spawn ssh $&#123;user&#125;@$&#123;ip&#125;</span><br><span class="line"></span><br><span class="line">expect &#123;</span><br><span class="line">	&quot;yes/no&quot; &#123; send &quot;yes\n&quot;;exp_continue&#125;</span><br><span class="line">	&quot;password&quot; &#123; send &quot;$passwd\n&quot; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"># 允许交互式操作</span><br><span class="line">interact</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 添加执行权限</span><br><span class="line">[root@centos7 ~]# chmmod +x expect3</span><br><span class="line"># 后面跟三个参数</span><br><span class="line">[root@centos7 ~]# ./expect3 192.168.179.138 root 123456</span><br></pre></td></tr></table></figure>

<p><strong>范例5:执行多个命令</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/expect</span><br><span class="line"></span><br><span class="line"># 添加变量</span><br><span class="line">set ip [lindex $argv 0]</span><br><span class="line">set user [lindex $argv 1]</span><br><span class="line">set passwd [lindex $argv 2]</span><br><span class="line">set timeout 10</span><br><span class="line"></span><br><span class="line"># 启动新的进程</span><br><span class="line">spawn ssh $&#123;user&#125;@$&#123;ip&#125;</span><br><span class="line"></span><br><span class="line">expect &#123;</span><br><span class="line">	&quot;yes/no&quot; &#123; send &quot;yes\n&quot;;exp_continue&#125;</span><br><span class="line">	&quot;password&quot; &#123; send &quot;$passwd\n&quot; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"># adduser haha</span><br><span class="line">expect &quot;]#&quot; &#123; send &quot;useradd haha\n&quot; &#125;</span><br><span class="line"># passwd set 123456</span><br><span class="line">expect &quot;]#&quot; &#123; send &quot;echo 123456 |passwd --stdin haha\n&quot; &#125;</span><br><span class="line"># logout</span><br><span class="line">send &quot;exit\n&quot;</span><br><span class="line">expect eof</span><br><span class="line"></span><br><span class="line">[root@centos7 ~]# ./expect4 192.168.179.141 root 123456</span><br></pre></td></tr></table></figure>

<p><strong>范例6:shell脚本调用expect</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">ip=$1</span><br><span class="line">user=$2</span><br><span class="line">password=$3</span><br><span class="line">expect &lt;&lt;EOF</span><br><span class="line">set timeout 20</span><br><span class="line"># 开启新的进程，登录远程主机</span><br><span class="line">spawn ssh $user@$ip</span><br><span class="line">expect &#123;</span><br><span class="line">&quot;yes/no&quot; &#123; send &quot;yes\n&quot;;exp_continue &#125;</span><br><span class="line">&quot;password&quot; &#123; send &quot;$password\n&quot; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 添加新的用户</span><br><span class="line">expect &quot;]#&quot; &#123; send &quot;useradd hehe\n&quot; &#125;</span><br><span class="line"># 设置新密码</span><br><span class="line">expect &quot;]#&quot; &#123; send &quot;echo 123456 |passwd --stdin hehe\n&quot; &#125;</span><br><span class="line"># logout</span><br><span class="line">expect &quot;]#&quot; &#123; send &quot;exit\n&quot; &#125;</span><br><span class="line">expect eof</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]# bash expect5.sh 192.168.179.141 root 123456</span><br></pre></td></tr></table></figure>

<p><strong>范例7: shell脚本利用循环调用expect在CentOS和Ubuntu上批量创建用户</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">NET=10.0.0</span><br><span class="line">user=root</span><br><span class="line">password=magedu</span><br><span class="line">IPLIST=&quot;</span><br><span class="line">7</span><br><span class="line">18</span><br><span class="line">101</span><br><span class="line">&quot;</span><br><span class="line">for ID in $IPLIST;do</span><br><span class="line">ip=$NET.$ID</span><br><span class="line">expect &lt;&lt;EOF</span><br><span class="line">set timeout 20</span><br><span class="line">spawn ssh $user@$ip</span><br><span class="line">expect &#123;</span><br><span class="line">&quot;yes/no&quot; &#123; send &quot;yes\n&quot;;exp_continue &#125;</span><br><span class="line">&quot;password&quot; &#123; send &quot;$password\n&quot; &#125;</span><br><span class="line">&#125;</span><br><span class="line">expect &quot;#&quot; &#123; send &quot;useradd test\n&quot; &#125;</span><br><span class="line">expect &quot;#&quot; &#123; send &quot;exit\n&quot; &#125;</span><br><span class="line">expect eof</span><br><span class="line">EOF</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h1 id="6-数组"><a href="#6-数组" class="headerlink" title="6 数组"></a>6 数组</h1><h2 id="6-1-数组介绍"><a href="#6-1-数组介绍" class="headerlink" title="6.1 数组介绍"></a>6.1 数组介绍</h2><p>变量：存储单个元素的内存空间<br>数组：存储多个元素的连续的内存空间，相当于多个变量的集合<br>数组名和索引</p>
<ul>
<li>索引的编号从0开始，属于数值索引</li>
<li>索引可支持使用自定义的格式，而不仅是数值格式，即为关联索引，bash 4.0版本之后开始支持</li>
<li>bash的数组支持稀疏格式（索引不连续）</li>
</ul>
<h2 id="6-2-声明数组"><a href="#6-2-声明数组" class="headerlink" title="6.2 声明数组"></a>6.2 声明数组</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#普通数组可以不事先声明,直接使用</span><br><span class="line">declare -a ARRAY_NAME</span><br><span class="line">#关联数组必须先声明,再使用</span><br><span class="line">declare -A ARRAY_NAME</span><br></pre></td></tr></table></figure>

<p><strong>注:两者不可相互转换</strong></p>
<h2 id="6-3-数组赋值"><a href="#6-3-数组赋值" class="headerlink" title="6.3 数组赋值"></a>6.3 数组赋值</h2><p>数组元素的赋值<br>**(1) 一次只赋值一个元素  **</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ARRAY_NAME[INDEX]=VALUE</span><br></pre></td></tr></table></figure>
<p><strong>范例：</strong>  </p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">weekdays[0]=&quot;Sunday&quot;</span><br><span class="line">weekdays[4]=&quot;Thursday&quot;</span><br></pre></td></tr></table></figure>

<p><strong>(2) 一次赋值全部元素</strong>  </p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ARRAY_NAME=(&quot;VAL1&quot; &quot;VAL2&quot; &quot;VAL3&quot; ...)</span><br></pre></td></tr></table></figure>
<p><strong>范例:</strong>  </p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title=(&quot;ceo&quot; &quot;coo&quot; &quot;cto&quot;)</span><br><span class="line">num=(&#123;0..10&#125;)</span><br><span class="line">alpha=(&#123;a..g&#125;)</span><br><span class="line">file=( *.sh )</span><br></pre></td></tr></table></figure>

<p><strong>(3)只赋值特定元素</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ARRAY_NAME=([0]=&quot;VAL1&quot; [3]=&quot;VAL2&quot; ...)</span><br></pre></td></tr></table></figure>

<p><strong>(4)交互式赋值元素</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read -a ARRAY</span><br></pre></td></tr></table></figure>

<h2 id="6-4-显示所有数组"><a href="#6-4-显示所有数组" class="headerlink" title="6.4 显示所有数组"></a>6.4 显示所有数组</h2><p><strong>显示所有数组</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">declare -a</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]# declare -a</span><br><span class="line">declare -a BASH_ARGC=&#x27;()&#x27;</span><br><span class="line">declare -a BASH_ARGV=&#x27;()&#x27;</span><br><span class="line">declare -a BASH_LINENO=&#x27;()&#x27;</span><br><span class="line">declare -a BASH_SOURCE=&#x27;()&#x27;</span><br><span class="line">declare -ar BASH_VERSINFO=&#x27;([0]=&quot;4&quot; [1]=&quot;2&quot; [2]=&quot;46&quot; [3]=&quot;2&quot; [4]=&quot;release&quot; [5]=&quot;x86_64-redhat-linux-gnu&quot;)&#x27;</span><br><span class="line">declare -a DIRSTACK=&#x27;()&#x27;</span><br><span class="line">declare -a FUNCNAME=&#x27;()&#x27;</span><br><span class="line">declare -a GROUPS=&#x27;()&#x27;</span><br><span class="line">declare -a PIPESTATUS=&#x27;([0]=&quot;0&quot;)&#x27;</span><br><span class="line">[root@centos7 ~]# </span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="6-5-引用数组"><a href="#6-5-引用数组" class="headerlink" title="6.5 引用数组"></a>6.5 引用数组</h2><p><strong>引用特定的数组元素</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$&#123;ARRAY_NAME[INDEX]&#125;</span><br><span class="line">#如果省略[INDEX]表示引用下标为0的元素</span><br></pre></td></tr></table></figure>

<p><strong>引用所有数组元素</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$&#123;ARRAY_NAME[*]&#125;</span><br><span class="line">$&#123;ARRAY_NAME[@]&#125;</span><br></pre></td></tr></table></figure>

<p><strong>数组的长度，即数组的元素的个数</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#ARRAY_NAME[*]&#125;</span><br><span class="line">$&#123;#ARRAY_NAME[@]&#125;</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]# title[0]=1</span><br><span class="line">[root@centos7 ~]# title[1]=1</span><br><span class="line">[root@centos7 ~]# title[2]=1</span><br><span class="line">[root@centos7 ~]# echo $&#123;#title[*]&#125;</span><br><span class="line">3</span><br><span class="line">[root@centos7 ~]# </span><br></pre></td></tr></table></figure>

<p><strong>数组的所有下标</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$&#123;!ARRAY_NAME[*]&#125;</span><br><span class="line">$&#123;!ARRAY_NAME[@]&#125;</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]# title[0]=1</span><br><span class="line">[root@centos7 ~]# title[1]=1</span><br><span class="line">[root@centos7 ~]# title[2]=1</span><br><span class="line">[root@centos7 ~]# echo $&#123;!title[*]&#125;</span><br><span class="line">0 1 2</span><br><span class="line">[root@centos7 ~]# </span><br></pre></td></tr></table></figure>

<h2 id="6-6-删除数组"><a href="#6-6-删除数组" class="headerlink" title="6.6 删除数组"></a>6.6 删除数组</h2><p><strong>删除数组中的某个元素</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unset ARRAY[INDEX]</span><br></pre></td></tr></table></figure>

<p><strong>删除整个数组</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unset ARRAY</span><br></pre></td></tr></table></figure>

<h2 id="6-7-数组数据处理"><a href="#6-7-数组数据处理" class="headerlink" title="6.7 数组数据处理"></a>6.7 数组数据处理</h2><p><strong>数据切片</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$&#123;ARRAY[@]:offset:number&#125;</span><br><span class="line">$&#123;ARRAY[*]:offset:number&#125;</span><br><span class="line">offset #要跳过的元素个数</span><br><span class="line">number #要取出的元素个数</span><br><span class="line">#取偏移量之后的所有元素</span><br><span class="line">&#123;ARRAY[@]:offset&#125;</span><br><span class="line">&#123;ARRAY[*]:offset&#125;</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#num=(&#123;0..10&#125;)</span><br><span class="line">[root@centos8 ~]#echo $&#123;num[*]:2:3&#125;</span><br><span class="line">2 3 4</span><br><span class="line">[root@centos8 ~]#echo $&#123;num[*]:6&#125;</span><br><span class="line">6 7 8 9 10</span><br></pre></td></tr></table></figure>

<p><strong>向数组中追加元素</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ARRAY[$&#123;#ARRAY[*]&#125;]=value</span><br><span class="line">ARRAY[$&#123;#ARRAY[@]&#125;]=value</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#num[$&#123;#num[@]&#125;]=11</span><br><span class="line">[root@centos8 ~]#echo $&#123;#num[@]&#125;</span><br><span class="line">12</span><br><span class="line">[root@centos8 ~]#echo $&#123;num[@]&#125;</span><br><span class="line">0 1 2 3 4 5 6 7 8 9 10 11</span><br></pre></td></tr></table></figure>

<p><strong>范例：生成10个随机数保存于数组中，并找出其最大值和最小值</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">declare -i min max</span><br><span class="line">declare -a nums</span><br><span class="line">for ((i=0;i&lt;10;i++));do</span><br><span class="line">nums[$i]=$RANDOM</span><br><span class="line">[ $i -eq 0 ] &amp;&amp; min=$&#123;nums[0]&#125; &amp;&amp; max=$&#123;nums[0]&#125;&amp;&amp; continue</span><br><span class="line">[ $&#123;nums[$i]&#125; -gt $max ] &amp;&amp; max=$&#123;nums[$i]&#125; &amp;&amp; continue</span><br><span class="line">[ $&#123;nums[$i]&#125; -lt $min ] &amp;&amp; min=$&#123;nums[$i]&#125;</span><br><span class="line">done</span><br><span class="line">echo &quot;All numbers are $&#123;nums[*]&#125;&quot;</span><br><span class="line">echo Max is $max</span><br><span class="line">echo Min is $min</span><br></pre></td></tr></table></figure>

<h1 id="7-字符串处理"><a href="#7-字符串处理" class="headerlink" title="7 字符串处理"></a>7 字符串处理</h1><h2 id="7-1-字符串切片"><a href="#7-1-字符串切片" class="headerlink" title="7.1 字符串切片"></a>7.1 字符串切片</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#返回字符串变量var的字符的长度,一个汉字算一个字符</span><br><span class="line">$&#123;#var&#125;</span><br><span class="line">#返回字符串变量var中从第offset个字符后（不包括第offset个字符）的字符开始，到最后的部分，</span><br><span class="line">offset的取值在0 到 $&#123;#var&#125;-1 之间(bash4.2后，允许为负值)</span><br><span class="line">$&#123;var:offset&#125;</span><br><span class="line">#返回字符串变量var中从第offset个字符后（不包括第offset个字符）的字符开始，长度为number的部分</span><br><span class="line">$&#123;var:offset:number&#125;</span><br><span class="line">#取字符串的最右侧几个字符,取字符串的最右侧几个字符, 注意：冒号后必须有一空白字符</span><br><span class="line">$&#123;var: -length&#125;</span><br><span class="line">#从最左侧跳过offset字符，一直向右取到距离最右侧lengh个字符之前的内容,即:掐头去尾</span><br><span class="line">$&#123;var:offset:-length&#125;</span><br><span class="line">#先从最右侧向左取到length个字符开始，再向右取到距离最右侧offset个字符之间的内容,注意：-</span><br><span class="line">length前空格,并且length必须大于offset</span><br><span class="line">$&#123;var: -length:-offset&#125;</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 script40]#str=abcdef我你他</span><br><span class="line">[root@centos8 script40]#echo $&#123;#str&#125;</span><br><span class="line">9</span><br><span class="line">[root@centos8 script40]#echo $&#123;str:2&#125;</span><br><span class="line">cdef我你他</span><br><span class="line">[root@centos8 script40]#echo $&#123;str:2:3&#125;</span><br><span class="line">cde</span><br><span class="line">[root@centos8 script40]#echo $&#123;str:-3&#125;</span><br><span class="line">abcdef我你他</span><br><span class="line">[root@centos8 script40]#echo $&#123;str: -3&#125;</span><br><span class="line">我你他</span><br><span class="line">[root@centos8 script40]#echo $&#123;str:2:-3&#125;</span><br><span class="line">cdef</span><br><span class="line">[root@centos8 script40]#echo $&#123;str: -2:-3&#125;</span><br><span class="line">-bash: -3: substring expression &lt; 0</span><br><span class="line">[root@centos8 script40]#echo $&#123;str: -3:-2&#125;</span><br><span class="line">我</span><br><span class="line">[root@centos8 script40]#echo $&#123;str:-3:-2&#125;</span><br><span class="line">abcdef我你他</span><br><span class="line">[root@centos8 script40]#echo $&#123;str: -3:-2&#125;</span><br><span class="line">我</span><br><span class="line">[root@centos8 script40]#echo $&#123;str: -5:-2&#125;</span><br><span class="line">ef我</span><br></pre></td></tr></table></figure>

<h2 id="7-2-基于模式取子串"><a href="#7-2-基于模式取子串" class="headerlink" title="7.2 基于模式取子串"></a>7.2 基于模式取子串</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#其中word可以是指定的任意字符,自左而右，查找var变量所存储的字符串中，第一次出现的word, 删除字</span><br><span class="line">符串开头至第一次出现word字符串（含）之间的所有字符,即懒惰模式,以第一个word为界删左留右</span><br><span class="line">$&#123;var#*word&#125;</span><br><span class="line">#从var变量的值中删除以word开头的部分</span><br><span class="line">$&#123;var#word&#125;</span><br><span class="line">#同上，贪婪模式，不同的是，删除的是字符串开头至最后一次由word指定的字符之间的所有内容,即贪婪模</span><br><span class="line">式,以最后一个word为界删左留右</span><br><span class="line">$&#123;var##*word&#125;</span><br><span class="line">$&#123;var##word&#125;</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#file=&quot;var/log/messages&quot;</span><br><span class="line">[root@centos8 ~]#echo $&#123;file#*/&#125;</span><br><span class="line">log/messages</span><br><span class="line">[root@centos8 ~]#echo $&#123;file##*/&#125;</span><br><span class="line">messages</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#其中word可以是指定的任意字符,功能：自右而左，查找var变量所存储的字符串中，第一次出现的word,</span><br><span class="line">删除字符串最后一个字符向左至第一次出现word字符串（含）之间的所有字符,即懒惰模式,以从右向左的第</span><br><span class="line">一个word为界删右留左</span><br><span class="line">$&#123;var%word*&#125;</span><br><span class="line">$&#123;var%word&#125;</span><br><span class="line">#同上，只不过删除字符串最右侧的字符向左至最后一次出现word字符之间的所有字符,即贪婪模式,以从右向</span><br><span class="line">左的最后一个word为界删右留左</span><br><span class="line">$&#123;var%%word*&#125;</span><br><span class="line">$&#123;var%%word&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-3-查找和替换"><a href="#7-3-查找和替换" class="headerlink" title="7.3 查找和替换"></a>7.3 查找和替换</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#查找var所表示的字符串中，第一次被pattern所匹配到的字符串，以substr替换之</span><br><span class="line">$&#123;var/pattern/substr&#125;</span><br><span class="line">#查找var所表示的字符串中，所有能被pattern所匹配到的字符串，以substr替换之</span><br><span class="line">$&#123;var//pattern/substr&#125;</span><br><span class="line">#查找var所表示的字符串中，行首被pattern所匹配到的字符串，以substr替换之</span><br><span class="line">$&#123;var/#pattern/substr&#125;</span><br><span class="line">#查找var所表示的字符串中，行尾被pattern所匹配到的字符串，以substr替换之</span><br><span class="line">$&#123;var/%pattern/substr&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-4-查找和删除"><a href="#7-4-查找和删除" class="headerlink" title="7.4 查找和删除"></a>7.4 查找和删除</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#删除var表示的字符串中第一次被pattern匹配到的字符串</span><br><span class="line">$&#123;var/pattern&#125;</span><br><span class="line">#删除var表示的字符串中所有被pattern匹配到的字符串</span><br><span class="line">$&#123;var//pattern&#125;</span><br><span class="line">#删除var表示的字符串中所有以pattern为行首匹配到的字符串</span><br><span class="line">$&#123;var/#pattern&#125;</span><br><span class="line">#删除var所表示的字符串中所有以pattern为行尾所匹配到的字符串</span><br><span class="line">$&#123;var/%pattern&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-5-字符大小写转换"><a href="#7-5-字符大小写转换" class="headerlink" title="7.5 字符大小写转换"></a>7.5 字符大小写转换</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#把var中的所有小写字母转换为大写</span><br><span class="line">$&#123;var^^&#125;</span><br><span class="line">#把var中的所有大写字母转换为小写</span><br><span class="line">$&#123;var,,&#125;</span><br></pre></td></tr></table></figure>


  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/categories/">分类</a></li>
         
          <li><a href="/search/">搜索</a></li>
         
          <li><a href="/about/">关于</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E5%AE%B9%E7%AE%80%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">内容简述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80"><span class="toc-number">2.</span> <span class="toc-text">1.编程基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E7%A8%8B%E5%BA%8F%E7%BB%84%E6%88%90"><span class="toc-number">2.1.</span> <span class="toc-text">1.1 程序组成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E7%A8%8B%E5%BA%8F%E7%BC%96%E7%A8%8B%E9%A3%8E%E6%A0%BC"><span class="toc-number">2.2.</span> <span class="toc-text">1.2 程序编程风格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80"><span class="toc-number">2.3.</span> <span class="toc-text">1.3 编程语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E7%BC%96%E7%A8%8B%E9%80%BB%E8%BE%91%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F"><span class="toc-number">2.4.</span> <span class="toc-text">1.4 编程逻辑处理方式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-shell-%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">2.shell 脚本语言的基本用法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-shell-%E8%84%9A%E6%9C%AC%E7%9A%84%E7%94%A8%E9%80%94"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 shell 脚本的用途</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-shell%E8%84%9A%E6%9C%AC%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 shell脚本基本结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-shell%E8%84%9A%E6%9C%AC%E5%88%9B%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 shell脚本创建过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-shell%E8%84%9A%E6%9C%AC%E6%B3%A8%E9%87%8A%E8%A7%84%E8%8C%83"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 shell脚本注释规范</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E7%AC%AC%E4%B8%80%E4%B8%AAshell%E8%84%9A%E6%9C%AC"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 第一个shell脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-shell%E8%84%9A%E6%9C%AC%E8%B0%83%E8%AF%95"><span class="toc-number">3.6.</span> <span class="toc-text">2.6 shell脚本调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.</span> <span class="toc-text">2.7 变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-1-%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.1.</span> <span class="toc-text">2.7.1 变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-2-%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.7.2.</span> <span class="toc-text">2.7.2 变量类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-3-shell%E4%B8%AD%E5%8F%98%E9%87%8F%E5%91%BD%E4%BB%A4%E8%A7%84%E5%88%99"><span class="toc-number">3.7.3.</span> <span class="toc-text">2.7.3 shell中变量命令规则</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-3-1-%E5%91%BD%E5%90%8D%E8%A6%81%E6%B1%82"><span class="toc-number">3.7.3.1.</span> <span class="toc-text">2.7.3.1 命名要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-3-2-%E5%91%BD%E4%BB%A4%E4%B9%A0%E6%83%AF"><span class="toc-number">3.7.3.2.</span> <span class="toc-text">2.7.3.2 命令习惯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-4-%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89%E5%92%8C%E5%BC%95%E7%94%A8"><span class="toc-number">3.7.4.</span> <span class="toc-text">2.7.4 变量定义和引用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-5-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.5.</span> <span class="toc-text">2.7.5 环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-6-%E5%8F%AA%E8%AF%BB%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.6.</span> <span class="toc-text">2.7.6 只读变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-7-%E4%BD%8D%E7%BD%AE%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.7.</span> <span class="toc-text">2.7.7 位置变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-8-%E5%88%A9%E7%94%A8%E8%BD%AF%E9%93%BE%E6%8E%A5%E5%AE%9E%E7%8E%B0%E5%90%8C%E4%B8%80%E4%B8%AA%E8%84%9A%E6%9C%AC%E4%B8%8D%E5%90%8C%E5%8A%9F%E8%83%BD"><span class="toc-number">3.7.8.</span> <span class="toc-text">2.7.8  利用软链接实现同一个脚本不同功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-9-%E9%80%80%E5%87%BA%E7%8A%B6%E6%80%81%E7%A0%81%E5%8F%98%E9%87%8F"><span class="toc-number">3.7.9.</span> <span class="toc-text">2.7.9 退出状态码变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-10-%E8%84%9A%E6%9C%AC%E5%AE%89%E5%85%A8%E5%92%8C-set"><span class="toc-number">3.7.10.</span> <span class="toc-text">2.7.10 脚本安全和 set</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8-%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97"><span class="toc-number">3.8.</span> <span class="toc-text">2.8 算术运算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-9-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><span class="toc-number">3.9.</span> <span class="toc-text">2.9 逻辑运算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-10-%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95%E5%91%BD%E4%BB%A4"><span class="toc-number">3.10.</span> <span class="toc-text">2.10 条件测试命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-1-%E5%8F%98%E9%87%8F%E6%B5%8B%E8%AF%95"><span class="toc-number">3.10.1.</span> <span class="toc-text">2.10.1 变量测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-2-%E6%95%B0%E5%80%BC%E6%B5%8B%E8%AF%95"><span class="toc-number">3.10.2.</span> <span class="toc-text">2.10.2 数值测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-3-%E7%AE%97%E6%9C%AF%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%AF%94%E8%BE%83"><span class="toc-number">3.10.3.</span> <span class="toc-text">2.10.3 算术表达式比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-4-%E5%AD%97%E7%AC%A6%E7%AA%9C%E6%B5%8B%E8%AF%95"><span class="toc-number">3.10.4.</span> <span class="toc-text">2.10.4 字符窜测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10-5-%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="toc-number">3.10.5.</span> <span class="toc-text">2.10.5 文件测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-11-%E5%85%B3%E4%BA%8E%EF%BC%88%EF%BC%89%E5%92%8C"><span class="toc-number">3.11.</span> <span class="toc-text">2.11 关于（）和{}</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-12-%E7%BB%84%E5%90%88%E6%B5%8B%E8%AF%95"><span class="toc-number">3.12.</span> <span class="toc-text">2.12 组合测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-12-1-%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">3.12.1.</span> <span class="toc-text">2.12.1 第一种方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-12-2-%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">3.12.2.</span> <span class="toc-text">2.12.2 第二种方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-13-%E4%BD%BF%E7%94%A8read%E5%91%BD%E4%BB%A4%E6%9D%A5%E6%8E%A5%E5%8F%97%E8%BE%93%E5%85%A5"><span class="toc-number">3.13.</span> <span class="toc-text">2.13 使用read命令来接受输入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E6%9D%A1%E4%BB%B6%E9%80%89%E6%8B%A9if"><span class="toc-number">4.</span> <span class="toc-text">3  条件选择if</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%BE%AA%E7%8E%AF"><span class="toc-number">5.</span> <span class="toc-text">4 循环</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-for%E5%BE%AA%E7%8E%AF"><span class="toc-number">5.1.</span> <span class="toc-text">4.1 for循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-while%E5%BE%AA%E7%8E%AF"><span class="toc-number">5.2.</span> <span class="toc-text">4.2 while循环</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E5%85%B6%E4%BB%96%E8%84%9A%E6%9C%AC%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7"><span class="toc-number">6.</span> <span class="toc-text">5 其他脚本相关工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-trap%E5%91%BD%E4%BB%A4"><span class="toc-number">6.1.</span> <span class="toc-text">5.1 trap命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-except%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E5%8C%96%E7%9A%84%E9%9D%9E%E4%BA%A4%E4%BA%92%E6%93%8D%E4%BD%9C"><span class="toc-number">6.2.</span> <span class="toc-text">5. 2 except实现自动化的非交互操作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E6%95%B0%E7%BB%84"><span class="toc-number">7.</span> <span class="toc-text">6 数组</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E6%95%B0%E7%BB%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">7.1.</span> <span class="toc-text">6.1 数组介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-%E5%A3%B0%E6%98%8E%E6%95%B0%E7%BB%84"><span class="toc-number">7.2.</span> <span class="toc-text">6.2 声明数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E6%95%B0%E7%BB%84%E8%B5%8B%E5%80%BC"><span class="toc-number">7.3.</span> <span class="toc-text">6.3 数组赋值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-%E6%98%BE%E7%A4%BA%E6%89%80%E6%9C%89%E6%95%B0%E7%BB%84"><span class="toc-number">7.4.</span> <span class="toc-text">6.4 显示所有数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-%E5%BC%95%E7%94%A8%E6%95%B0%E7%BB%84"><span class="toc-number">7.5.</span> <span class="toc-text">6.5 引用数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6-%E5%88%A0%E9%99%A4%E6%95%B0%E7%BB%84"><span class="toc-number">7.6.</span> <span class="toc-text">6.6 删除数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-7-%E6%95%B0%E7%BB%84%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">7.7.</span> <span class="toc-text">6.7 数组数据处理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86"><span class="toc-number">8.</span> <span class="toc-text">7 字符串处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%87%E7%89%87"><span class="toc-number">8.1.</span> <span class="toc-text">7.1 字符串切片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E5%9F%BA%E4%BA%8E%E6%A8%A1%E5%BC%8F%E5%8F%96%E5%AD%90%E4%B8%B2"><span class="toc-number">8.2.</span> <span class="toc-text">7.2 基于模式取子串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E6%9F%A5%E6%89%BE%E5%92%8C%E6%9B%BF%E6%8D%A2"><span class="toc-number">8.3.</span> <span class="toc-text">7.3 查找和替换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-%E6%9F%A5%E6%89%BE%E5%92%8C%E5%88%A0%E9%99%A4"><span class="toc-number">8.4.</span> <span class="toc-text">7.4 查找和删除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-5-%E5%AD%97%E7%AC%A6%E5%A4%A7%E5%B0%8F%E5%86%99%E8%BD%AC%E6%8D%A2"><span class="toc-number">8.5.</span> <span class="toc-text">7.5 字符大小写转换</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&text=shell编程"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&title=shell编程"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&is_video=false&description=shell编程"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=shell编程&body=Check out this article: http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&title=shell编程"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&title=shell编程"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&title=shell编程"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&title=shell编程"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&name=shell编程&description=shell 是操作系统的最外层。shell 合并编程语言以控制进程和文件，以及启动和控制其它程序。shell 通过提示您输入，向操作系统解释该输入，然后处理来自操作系统的任何结果输出来管理您与操作系统之间的交互。"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/08/03/shell%E7%BC%96%E7%A8%8B/&t=shell编程"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2023
    yuan kun
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     -->
      </ul>
    </nav>
<!--<p class="size-small">
    <a href="http://www.beian.miit.gov.cn" target="_blank" rel="noopener">黔ICP备2022006994号</a>
  </p>-->
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
