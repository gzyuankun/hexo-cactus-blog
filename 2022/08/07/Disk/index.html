<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="磁盘是计算机主要的存储介质，可以存储大量的二进制数据，并且断电后也能保持数据不丢失，使用磁盘存储数据的时候我们可以将磁盘划分成我们所需要的格式来进行使用。">
<meta property="og:type" content="article">
<meta property="og:title" content="磁盘存储和文件系统管理">
<meta property="og:url" content="http://cactus.itshare.work/2022/08/07/Disk/index.html">
<meta property="og:site_name" content="Cookie">
<meta property="og:description" content="磁盘是计算机主要的存储介质，可以存储大量的二进制数据，并且断电后也能保持数据不丢失，使用磁盘存储数据的时候我们可以将磁盘划分成我们所需要的格式来进行使用。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://cactus.itshare.work/image.assets/1659865748687.png">
<meta property="article:published_time" content="2022-08-07T00:40:59.000Z">
<meta property="article:modified_time" content="2023-03-03T10:15:39.934Z">
<meta property="article:tag" content="Linux从入门到放弃">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://cactus.itshare.work/image.assets/1659865748687.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>磁盘存储和文件系统管理</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2022/08/08/homework/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2022/08/03/shell%E7%BC%96%E7%A8%8B/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://cactus.itshare.work/2022/08/07/Disk/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://cactus.itshare.work/2022/08/07/Disk/&text=磁盘存储和文件系统管理"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://cactus.itshare.work/2022/08/07/Disk/&title=磁盘存储和文件系统管理"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://cactus.itshare.work/2022/08/07/Disk/&is_video=false&description=磁盘存储和文件系统管理"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=磁盘存储和文件系统管理&body=Check out this article: http://cactus.itshare.work/2022/08/07/Disk/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://cactus.itshare.work/2022/08/07/Disk/&title=磁盘存储和文件系统管理"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://cactus.itshare.work/2022/08/07/Disk/&title=磁盘存储和文件系统管理"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://cactus.itshare.work/2022/08/07/Disk/&title=磁盘存储和文件系统管理"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://cactus.itshare.work/2022/08/07/Disk/&title=磁盘存储和文件系统管理"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://cactus.itshare.work/2022/08/07/Disk/&name=磁盘存储和文件系统管理&description=磁盘是计算机主要的存储介质，可以存储大量的二进制数据，并且断电后也能保持数据不丢失，使用磁盘存储数据的时候我们可以将磁盘划分成我们所需要的格式来进行使用。"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://cactus.itshare.work/2022/08/07/Disk/&t=磁盘存储和文件系统管理"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86%E4%B8%8E%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.</span> <span class="toc-text">磁盘管理与文件系统</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E7%A3%81%E7%9B%98%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">1. 磁盘结构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E7%AE%A1%E7%90%86%E5%AD%98%E5%82%A8"><span class="toc-number">3.</span> <span class="toc-text">2. 管理存储</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 磁盘分区</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%88%86%E5%8C%BA"><span class="toc-number">3.1.1.</span> <span class="toc-text">2.1.1 为什么分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-%E5%88%86%E5%8C%BA%E6%96%B9%E5%BC%8F"><span class="toc-number">3.1.2.</span> <span class="toc-text">2.1.2 分区方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E7%AE%A1%E7%90%86%E5%88%86%E5%8C%BA"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 管理分区</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-%E6%B7%BB%E5%8A%A0%E5%B9%B6%E6%A3%80%E6%B5%8B%E6%96%B0%E7%A1%AC%E7%9B%98"><span class="toc-number">3.2.1.</span> <span class="toc-text">2.2.1 添加并检测新硬盘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-partend%E5%91%BD%E4%BB%A4"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.2.2 partend命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-3-%E5%88%86%E5%8C%BA%E5%B7%A5%E5%85%B7fdisk%E5%92%8Cgdisk"><span class="toc-number">3.2.3.</span> <span class="toc-text">2.2.3 分区工具fdisk和gdisk</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 文件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-1-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5"><span class="toc-number">3.3.1.</span> <span class="toc-text">2.3.1 文件系统概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-2-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.3.2.</span> <span class="toc-text">2.3.2 文件系统类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-3-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86"><span class="toc-number">3.3.3.</span> <span class="toc-text">2.3.3 文件系统的组成部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-4-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%80%89%E6%8B%A9%E7%AE%A1%E7%90%86"><span class="toc-number">3.3.4.</span> <span class="toc-text">2.3.4 文件系统选择管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-1-%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.3.4.1.</span> <span class="toc-text">2.3.4.1 创建文件系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-2-%E6%9F%A5%E7%9C%8B%E5%92%8C%E7%AE%A1%E7%90%86%E5%88%86%E5%8C%BA%E4%BF%A1%E6%81%AF"><span class="toc-number">3.3.4.2.</span> <span class="toc-text">2.3.4.2 查看和管理分区信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-3-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%A3%80%E6%B5%8B%E5%92%8C%E4%BF%AE%E5%A4%8D"><span class="toc-number">3.3.4.3.</span> <span class="toc-text">2.3.4.3 文件系统检测和修复</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E6%8C%82%E8%BD%BD"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 挂载</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-1-%E6%8C%82%E8%BD%BD%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-mount"><span class="toc-number">3.4.1.</span> <span class="toc-text">2.4.1 挂载文件系统 mount</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-2-%E5%8D%B8%E8%BD%BD%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-umount"><span class="toc-number">3.4.2.</span> <span class="toc-text">2.4.2 卸载文件系统 umount</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-3-%E6%9F%A5%E7%9C%8B%E6%8C%82%E8%BD%BD%E6%83%85%E5%86%B5"><span class="toc-number">3.4.3.</span> <span class="toc-text">2.4.3 查看挂载情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-4-%E6%8C%81%E4%B9%85%E6%8C%82%E8%BD%BD"><span class="toc-number">3.4.4.</span> <span class="toc-text">2.4.4 持久挂载</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E5%A4%84%E7%90%86%E4%BA%A4%E6%8D%A2%E6%96%87%E4%BB%B6%E5%92%8C%E5%88%86%E5%8C%BA"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 处理交换文件和分区</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-1-swap%E5%88%86%E5%8C%BA"><span class="toc-number">3.5.1.</span> <span class="toc-text">2.5.1 swap分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-2-%E4%BA%A4%E6%8D%A2%E5%88%86%E5%8C%BA%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B"><span class="toc-number">3.5.2.</span> <span class="toc-text">2.5.2 交换分区实现过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-3-swap%E7%9A%84%E4%BD%BF%E7%94%A8%E7%AD%96%E7%95%A5"><span class="toc-number">3.5.3.</span> <span class="toc-text">2.5.3 swap的使用策略</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-%E7%A3%81%E7%9B%98%E5%B8%B8%E8%A7%81%E5%B7%A5%E5%85%B7"><span class="toc-number">3.6.</span> <span class="toc-text">2.6 磁盘常见工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-1-df"><span class="toc-number">3.6.1.</span> <span class="toc-text">2.6.1 df</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-3-du"><span class="toc-number">3.6.2.</span> <span class="toc-text">2.6.3 du</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-RAID"><span class="toc-number">4.</span> <span class="toc-text">3. RAID</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        磁盘存储和文件系统管理
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name"></span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-08-07T00:40:59.000Z" itemprop="datePublished">2022-08-07</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Linux%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/" rel="tag">Linux从入门到放弃</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="磁盘管理与文件系统"><a href="#磁盘管理与文件系统" class="headerlink" title="磁盘管理与文件系统"></a>磁盘管理与文件系统</h1><p><strong>前言</strong><br>磁盘是计算机主要的存储介质，可以存储大量的二进制数据，并且断电后也能保持数据不丢失，使用磁盘存储数据的时候我们可以将磁盘划分成我们所需要的格式来进行使用</p>
<h1 id="1-磁盘结构"><a href="#1-磁盘结构" class="headerlink" title="1. 磁盘结构"></a>1. 磁盘结构</h1><p><strong>1、硬盘的物理结构</strong><br>盘片：硬盘有多个盘片，每个盘片有2面<br>磁头：每面有一个磁头</p>
<p><strong>2.硬盘数据结构</strong><br>扇区：磁盘上的每个磁道被等分为若干个弧段，这些弧段便是硬盘的扇区。硬盘的第一个扇区，叫做引导扇区 ，盘片被分为多个扇形区域，每个扇区存放512字节的数据，是硬盘最小的存储单元<br>磁道：当磁盘旋转时，磁头若保持在一个位置上，则每个磁头都会在磁盘表面划出一个圆形轨迹，这些圆形轨迹就叫做磁道<br>柱面：在有多个盘片构成的盘组中，由不同盘片的面，但处于同一半径圆的多个磁道组成的一个圆柱面</p>
<p><strong>3、磁盘结构</strong><br>硬盘存储容量 &#x3D; 磁头数 x 磁道（柱面）数 x 每道扇区数 x 每扇区字节数（512字节）<br>可以用柱面&#x2F;磁头&#x2F;扇区来唯一定位磁盘上的每一个区域<br>磁盘的接口类型：IDE、SATA、SCSI、SAS、光纤通道<br>用 fdisk -l 查看分区信息</p>
<h1 id="2-管理存储"><a href="#2-管理存储" class="headerlink" title="2. 管理存储"></a>2. 管理存储</h1><h2 id="2-1-磁盘分区"><a href="#2-1-磁盘分区" class="headerlink" title="2.1 磁盘分区"></a>2.1 磁盘分区</h2><h3 id="2-1-1-为什么分区"><a href="#2-1-1-为什么分区" class="headerlink" title="2.1.1 为什么分区"></a>2.1.1 为什么分区</h3><ul>
<li>优化I&#x2F;O性能</li>
<li>实现磁盘空间配额限制</li>
<li>提高修复速度</li>
<li>隔离系统和程序</li>
<li>安装多个OS</li>
<li>采用不同文件系统</li>
</ul>
<h3 id="2-1-2-分区方式"><a href="#2-1-2-分区方式" class="headerlink" title="2.1.2 分区方式"></a>2.1.2 分区方式</h3><p>两种分区方式：MBR，GPT</p>
<p><strong>MBR分区</strong></p>
<p>MBR：Master Boot Record，1982年，使用32位表示扇区数，分区不超过2T<br>划分分区的单位：<br>CentOS 5 之前按整柱面划分<br>CentOS 6 版本后可以按Sector划分<br>0磁道0扇区：512bytes<br>446bytes: boot loader 启动相关<br>64bytes：分区表，其中每16bytes标识一个分区<br>2bytes: 55AA，标识位<br>MBR分区中一块硬盘最多有4个主分区，也可以3主分区+1扩展(N个逻辑分区)<br>MBR分区：主和扩展分区对应的1–4，&#x2F;dev&#x2F;sda3，逻辑分区从5开始，&#x2F;dev&#x2F;sda5</p>
<p>问题：利用分区策略相同的另一台主机的分区表来还原和恢复当前主机破环的分区表？</p>
<p><strong>GPT分区</strong><br>GPT：GUID（Globals Unique Identifiers） partition table 支持128个分区，使用64位，支持8Z（<br>512Byte&#x2F;block ）64Z （ 4096Byte&#x2F;block）<br>使用128位UUID(Universally Unique Identifier) 表示磁盘和分区 GPT分区表自动备份在头和尾两份，<br>并有CRC校验位<br>UEFI (Unified Extensible Firmware Interface 统一可扩展固件接口)硬件支持GPT，使得操作系统可以<br>启动</p>
<p><strong>GPT分区结构分为4个区域：</strong></p>
<ul>
<li>GPT头</li>
<li>分区表</li>
<li>GPT分区</li>
<li>备份区域</li>
</ul>
<h2 id="2-2-管理分区"><a href="#2-2-管理分区" class="headerlink" title="2.2 管理分区"></a>2.2 管理分区</h2><p><strong>列出块设备</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk</span><br></pre></td></tr></table></figure>

<p><strong>创建分区命令</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fdisk 管理MBR分区</span><br><span class="line">gdisk 管理GPT分区</span><br><span class="line">parted 高级分区操作，可以是交互或非交互方式</span><br></pre></td></tr></table></figure>

<p><strong>重新设置内存中的内核分区表版本，适合于除了CentOS 6 以外的其它版本 5，7，8</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">partprobe</span><br></pre></td></tr></table></figure>

<h3 id="2-2-1-添加并检测新硬盘"><a href="#2-2-1-添加并检测新硬盘" class="headerlink" title="2.2.1 添加并检测新硬盘"></a>2.2.1 添加并检测新硬盘</h3><p>1、添加新硬盘使用lsblk命令显示出块设备</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:~# lsblk</span><br><span class="line">NAME                      MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">loop0                       7:0    0 61.9M  1 loop /snap/core20/1328</span><br><span class="line">loop1                       7:1    0 67.2M  1 loop /snap/lxd/21835</span><br><span class="line">loop2                       7:2    0   62M  1 loop /snap/core20/1587</span><br><span class="line">loop3                       7:3    0 43.6M  1 loop /snap/snapd/14978</span><br><span class="line">loop4                       7:4    0   47M  1 loop /snap/snapd/16292</span><br><span class="line">loop5                       7:5    0 67.8M  1 loop /snap/lxd/22753</span><br><span class="line">sda                         8:0    0   20G  0 disk </span><br><span class="line">├─sda1                      8:1    0    1M  0 part </span><br><span class="line">├─sda2                      8:2    0  1.5G  0 part /boot</span><br><span class="line">└─sda3                      8:3    0 18.5G  0 part </span><br><span class="line">  └─ubuntu--vg-ubuntu--lv 253:0    0   10G  0 lvm  /</span><br><span class="line">sr0                        11:0    1  1.2G  0 rom </span><br></pre></td></tr></table></figure>

<p>发现并没有检测出来新添加的硬盘</p>
<p> 2、检测新硬盘</p>
<p>方法1：可以重启电脑</p>
<p>方法2： 重新扫描存储设备的scsi总线 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># host后面的数字不是固定的，以实际为准</span><br><span class="line">root@ubuntu200404:~# echo &#x27;- - -&#x27; &gt; /sys/class/scsi_host/host32/scan</span><br></pre></td></tr></table></figure>

<p>再次使用lsblk命令查看发现已经多了sda的硬盘，说明成功了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:~# lsblk</span><br><span class="line">NAME                      MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">loop0                       7:0    0 61.9M  1 loop /snap/core20/1328</span><br><span class="line">loop1                       7:1    0 67.2M  1 loop /snap/lxd/21835</span><br><span class="line">loop2                       7:2    0   62M  1 loop /snap/core20/1587</span><br><span class="line">loop3                       7:3    0 43.6M  1 loop /snap/snapd/14978</span><br><span class="line">loop4                       7:4    0   47M  1 loop /snap/snapd/16292</span><br><span class="line">loop5                       7:5    0 67.8M  1 loop /snap/lxd/22753</span><br><span class="line">sda                         8:0    0   20G  0 disk </span><br><span class="line">├─sda1                      8:1    0    1M  0 part </span><br><span class="line">├─sda2                      8:2    0  1.5G  0 part /boot</span><br><span class="line">└─sda3                      8:3    0 18.5G  0 part </span><br><span class="line">  └─ubuntu--vg-ubuntu--lv 253:0    0   10G  0 lvm  /</span><br><span class="line">sdb                         8:16   0   20G  0 disk				# 新添加的硬盘 </span><br><span class="line">sr0                        11:0    1  1.2G  0 rom</span><br></pre></td></tr></table></figure>

<h3 id="2-2-2-partend命令"><a href="#2-2-2-partend命令" class="headerlink" title="2.2.2 partend命令"></a>2.2.2 partend命令</h3><p><strong>注意：parted的操作都是实时生效的，小心使用</strong></p>
<p>格式:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parted [选项]... [设备 [命令 [参数]...]...]</span><br></pre></td></tr></table></figure>

<p>范例：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">parted /dev/sdb mklabel gpt|msdos</span><br><span class="line">parted /dev/sdb print</span><br><span class="line">parted /dev/sdb mkpart primary 1 200 （默认M）</span><br><span class="line">parted /dev/sdb rm 1</span><br><span class="line">parted -l 列出所有硬盘分区信息</span><br></pre></td></tr></table></figure>

<h3 id="2-2-3-分区工具fdisk和gdisk"><a href="#2-2-3-分区工具fdisk和gdisk" class="headerlink" title="2.2.3 分区工具fdisk和gdisk"></a>2.2.3 分区工具fdisk和gdisk</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l [-u] [device...] 查看分区</span><br><span class="line">fdisk [device...] 管理MBR分区</span><br><span class="line">gdisk [device...] 类fdisk 的GPT分区工具</span><br><span class="line"></span><br><span class="line"># 范例：</span><br><span class="line">fdisk /dev/sdb</span><br></pre></td></tr></table></figure>

<p><strong>子命令：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p 分区列表</span><br><span class="line">t 更改分区类型</span><br><span class="line">n 创建新分区</span><br><span class="line">d 删除分区</span><br><span class="line">v 校验分区</span><br><span class="line">u 转换单位</span><br><span class="line">w 保存并退出</span><br><span class="line">q 不保存并退出</span><br></pre></td></tr></table></figure>

<p><strong>查看内核是否已经识别新的分区</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/partitions</span><br></pre></td></tr></table></figure>

<p><strong>CentOS 7,8 同步分区表:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">partprobe</span><br></pre></td></tr></table></figure>

<h2 id="2-3-文件系统"><a href="#2-3-文件系统" class="headerlink" title="2.3 文件系统"></a>2.3 文件系统</h2><h3 id="2-3-1-文件系统概念"><a href="#2-3-1-文件系统概念" class="headerlink" title="2.3.1 文件系统概念"></a>2.3.1 文件系统概念</h3><p>文件系统是操作系统用于明确存储设备或分区上的文件的方法和数据结构；即在存储设备上组织文件的<br>方法。操作系统中负责管理和存储文件信息的软件结构称为文件管理系统，简称文件系统<br>从系统角度来看，文件系统是对文件存储设备的空间进行组织和分配，负责文件存储并对存入的文件进<br>行保护和检索的系统。具体地说，它负责为用户建立文件，存入、读出、修改、转储文件，控制文件的<br>存取，安全控制，日志，压缩，加密等<br>支持的文件系统：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/lib/modules/`uname -r`/kernel/fs</span><br></pre></td></tr></table></figure>

<p>(各种文件系统)[<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Comparison_of_file_systems]">https://en.wikipedia.org/wiki/Comparison_of_file_systems]</a></p>
<p><strong>帮助：</strong>man 5 fs</p>
<h3 id="2-3-2-文件系统类型"><a href="#2-3-2-文件系统类型" class="headerlink" title="2.3.2 文件系统类型"></a>2.3.2 文件系统类型</h3><p><strong>Linux常用文件系统</strong></p>
<ul>
<li>ext2：Extended file system 适用于那些分区容量不是太大，更新也不频繁的情况，例如 &#x2F;boot 分<br>区</li>
<li>ext3：是 ext2 的改进版本，其支持日志功能，能够帮助系统从非正常关机导致的异常中恢复</li>
<li>ext4：是 ext 文件系统的最新版。提供了很多新的特性，包括纳秒级时间戳、创建和使用巨型文件<br>(16TB)、最大1EB的文件系统，以及速度的提升</li>
<li>xfs：SGI，支持最大8EB的文件系统</li>
<li>swap</li>
<li>iso9660 光盘</li>
<li>btrfs（Oracle）</li>
<li>reiserfs</li>
</ul>
<p><strong>Windows 常用文件系统</strong></p>
<ul>
<li>FAT32</li>
<li>NTFS</li>
<li>exFAT</li>
<li>Unix：</li>
<li>FFS（fast）</li>
<li>UFS（unix）</li>
<li>JFS2</li>
</ul>
<p><strong>网络文件系统：</strong></p>
<ul>
<li>NFS</li>
<li>CIFS</li>
</ul>
<p><strong>集群文件系统：</strong></p>
<ul>
<li>GFS2</li>
<li>OCFS2（oracle）</li>
</ul>
<p><strong>分布式文件系统：</strong></p>
<ul>
<li>fastdfs</li>
<li>ceph</li>
<li>moosefs</li>
<li>mogilefs</li>
<li>glusterfs</li>
<li>Lustre</li>
</ul>
<p><strong>RAW：</strong></p>
<p>裸文件系统,未经处理或者未经格式化产生的文件系统<br>常用的文件系统特性：</p>
<p><strong>FAT32</strong></p>
<ul>
<li>最多只能支持16TB的文件系统和4GB的文件</li>
</ul>
<p><strong>NTFS</strong></p>
<ul>
<li>最多只能支持16EB的文件系统和16EB的文件</li>
</ul>
<p><strong>EXT3</strong></p>
<ul>
<li>最多只能支持32TB的文件系统和2TB的文件，实际只能容纳2TB的文件系统和16GB的文件</li>
<li>Ext3目前只支持32000个子目录</li>
<li>Ext3文件系统使用32位空间记录块数量和 inode数量</li>
<li>当数据写入到Ext3文件系统中时，Ext3的数据块分配器每次只能分配一个4KB的块</li>
</ul>
<p><strong>EXT4：</strong></p>
<ul>
<li>EXT4是Linux系统下的日志文件系统，是EXT3文件系统的后继版本</li>
<li>Ext4的文件系统容量达到1EB，而支持单个文件则达到16TB</li>
<li>理论上支持无限数量的子目录</li>
<li>Ext4文件系统使用64位空间记录块数量和 inode数量</li>
<li>Ext4的多块分配器支持一次调用分配多个数据块</li>
<li>修复速度更快</li>
</ul>
<p><strong>XFS</strong></p>
<ul>
<li>根据所记录的日志在很短的时间内迅速恢复磁盘文件内容</li>
<li>用优化算法，日志记录对整体文件操作影响非常小</li>
<li>是一个全64-bit的文件系统，最大可以支持8EB的文件系统，而支持单个文件则达到8EB</li>
<li>能以接近裸设备I&#x2F;O的性能存储数据</li>
</ul>
<p><strong>查前支持的文件系统：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/filesystems</span><br></pre></td></tr></table></figure>

<h3 id="2-3-3-文件系统的组成部分"><a href="#2-3-3-文件系统的组成部分" class="headerlink" title="2.3.3 文件系统的组成部分"></a>2.3.3 文件系统的组成部分</h3><p>内核中的模块：ext4, xfs, vfat<br>Linux的虚拟文件系统：VFS<br>用户空间的管理工具：mkfs.ext4, mkfs.xfs,mkfs.vfat</p>
<h3 id="2-3-4-文件系统选择管理"><a href="#2-3-4-文件系统选择管理" class="headerlink" title="2.3.4 文件系统选择管理"></a>2.3.4 文件系统选择管理</h3><h4 id="2-3-4-1-创建文件系统"><a href="#2-3-4-1-创建文件系统" class="headerlink" title="2.3.4.1 创建文件系统"></a>2.3.4.1 创建文件系统</h4><p><strong>创建文件管理工具</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mkfs命令：</span><br><span class="line">(1) mkfs.FS_TYPE /dev/DEVICE</span><br><span class="line">ext4</span><br><span class="line">xfs</span><br><span class="line">btrfs</span><br><span class="line">vfat</span><br><span class="line">(2) mkfs -t FS_TYPE /dev/DEVICE</span><br><span class="line">-L &#x27;LABEL&#x27; 设定卷标</span><br><span class="line">mke2fs：ext系列文件系统专用管理工具</span><br></pre></td></tr></table></figure>
<p><strong>常用选项：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-t &#123;ext2|ext3|ext4|xfs&#125; 指定文件系统类型</span><br><span class="line">-b &#123;1024|2048|4096&#125; 指定块 block 大小</span><br><span class="line">-L ‘LABEL’ 设置卷标</span><br><span class="line">-j 相当于 -t ext3， mkfs.ext3 = mkfs -t ext3 = mke2fs -j = mke2fs -t ext3</span><br><span class="line">-i # 为数据空间中每多少个字节创建一个inode；不应该小于block大</span><br><span class="line">小</span><br><span class="line">-N # 指定分区中创建多少个inode</span><br><span class="line">-I 一个inode记录占用的磁盘空间大小，128---4096</span><br><span class="line">-m # 默认5%,为管理人员预留空间占总空间的百分比</span><br><span class="line">-O FEATURE[,...] 启用指定特性</span><br><span class="line">-O ^FEATURE </span><br></pre></td></tr></table></figure>

<p><strong>案例：mkfs.ext4 &#x2F;dev&#x2F;sdb1</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:~# mkfs.ext4 /dev/sdb1</span><br><span class="line">mke2fs 1.45.5 (07-Jan-2020)</span><br><span class="line">Creating filesystem with 2621440 4k blocks and 655360 inodes</span><br><span class="line">Filesystem UUID: a7ef4142-26e5-43dd-b9d0-24c4d09155a1</span><br><span class="line">Superblock backups stored on blocks: </span><br><span class="line">	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632</span><br><span class="line"></span><br><span class="line">Allocating group tables: done                            </span><br><span class="line">Writing inode tables: done                            </span><br><span class="line">Creating journal (16384 blocks): done</span><br><span class="line">Writing superblocks and filesystem accounting information: done </span><br><span class="line"></span><br><span class="line">root@ubuntu200404:~# </span><br></pre></td></tr></table></figure>

<h4 id="2-3-4-2-查看和管理分区信息"><a href="#2-3-4-2-查看和管理分区信息" class="headerlink" title="2.3.4.2 查看和管理分区信息"></a>2.3.4.2 查看和管理分区信息</h4><p>blkid 可以查看块设备属性信息<br>格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blkid [OPTION]... [DEVICE]</span><br></pre></td></tr></table></figure>

<p>常用选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-U UUID 根据指定的UUID来查找对应的设备</span><br><span class="line">-L LABEL 根据指定的LABEL来查找对应的设备</span><br><span class="line">e2label：管理ext系列文件系统的LABEL</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e2label DEVICE [LABEL]</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:~# blkid /dev/sdb1</span><br><span class="line">/dev/sdb1: UUID=&quot;a7ef4142-26e5-43dd-b9d0-24c4d09155a1&quot; TYPE=&quot;ext4&quot; PARTUUID=&quot;db60ac71-01&quot;</span><br><span class="line">root@ubuntu200404:~# </span><br></pre></td></tr></table></figure>

<p><strong>查找分区</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">findfs [options] LABEL=&lt;label&gt;</span><br><span class="line">findfs [options] UUID=&lt;uuid&gt;</span><br></pre></td></tr></table></figure>

<p><strong>tune2fs：重新设定ext系列文件系统可调整参数的值</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-l 查看指定文件系统超级块信息；super block</span><br><span class="line">-L &#x27;LABEL’ 修改卷标</span><br><span class="line">-m # 修预留给管理员的空间百分比</span><br><span class="line">-j 将ext2升级为ext3</span><br><span class="line">-O 文件系统属性启用或禁用, -O ^has_journal</span><br><span class="line">-o 调整文件系统的默认挂载选项，-o ^acl</span><br><span class="line">-U UUID 修改UUID号</span><br></pre></td></tr></table></figure>

<p><strong>dumpe2fs：显示ext文件系统信息，将磁盘块分组管理</strong><br>-h：查看超级块信息，不显示分组信息</p>
<p><strong>范例：查看ext文件系统的元数据和块组信息</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:~# dumpe2fs /dev/sdb1</span><br><span class="line">dumpe2fs 1.45.5 (07-Jan-2020)</span><br><span class="line">Filesystem volume name:   &lt;none&gt;</span><br><span class="line">Last mounted on:          &lt;not available&gt;</span><br><span class="line">Filesystem UUID:          a7ef4142-26e5-43dd-b9d0-24c4d09155a1</span><br><span class="line">Filesystem magic number:  0xEF53</span><br><span class="line">Filesystem revision #:    1 (dynamic)</span><br><span class="line">Filesystem features:      has_journal ext_attr resize_inode dir_index filetype extent 64bit flex_bg sparse_super large_file huge_file dir_nlink extra_isize metadata_csum</span><br><span class="line">Filesystem flags:         signed_directory_hash </span><br><span class="line">Default mount options:    user_xattr acl</span><br><span class="line">Filesystem state:         clean</span><br><span class="line">Errors behavior:          Continue</span><br><span class="line">Filesystem OS type:       Linux</span><br><span class="line">Inode count:              655360</span><br><span class="line">Block count:              2621440</span><br><span class="line">Reserved block count:     131072</span><br><span class="line">Free blocks:              2554687</span><br><span class="line">Free inodes:              655349</span><br><span class="line">First block:              0</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p><strong>xfs_info：显示示挂载或已挂载的 xfs 文件系统信息</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_info mountpoint|devname</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_info /dev/sda1</span><br></pre></td></tr></table></figure>

<h4 id="2-3-4-3-文件系统检测和修复"><a href="#2-3-4-3-文件系统检测和修复" class="headerlink" title="2.3.4.3 文件系统检测和修复"></a>2.3.4.3 文件系统检测和修复</h4><p>文件系统夹故障常发生于死机或者非正常关机之后，挂载为文件系统标记为“no clean”<br><strong>注意：一定不要在挂载状态下执行下面命令修复</strong></p>
<p>fsck: File System Check</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fsck.FS_TYPE</span><br><span class="line">fsck -t FS_TYPE</span><br></pre></td></tr></table></figure>

<p><strong>注意：FS_TYPE 一定要与分区上已经文件类型相同</strong></p>
<p><strong>常用选项</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-a 自动修复</span><br><span class="line">-r 交互式修复错误</span><br></pre></td></tr></table></figure>

<p><strong>e2fsck：ext系列文件专用的检测修复工具</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-y 自动回答为yes</span><br><span class="line">-f 强制修复</span><br><span class="line">-p 自动进行安全的修复文件系统问题</span><br></pre></td></tr></table></figure>

<p><strong>用法：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e2fsck /dev/sdb2</span><br></pre></td></tr></table></figure>

<p><strong>xfs_repair：xfs文件系统专用检测修复工具</strong><br><strong>常用选项：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-f 修复文件，而设备</span><br><span class="line">-n 只检查</span><br><span class="line">-d 允许修复只读的挂载设备，在单用户下修复 / 时使用，然后立即reboot</span><br></pre></td></tr></table></figure>

<p><strong>用法：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_repair /dev/sda1 </span><br></pre></td></tr></table></figure>

<h2 id="2-4-挂载"><a href="#2-4-挂载" class="headerlink" title="2.4 挂载"></a>2.4 挂载</h2><p>挂载:将额外文件系统与根文件系统某现存的目录建立起关联关系，进而使得此目录做为其它文件访问入<br>口的行为<br>卸载:为解除此关联关系的过程<br>把设备关联挂载点：mount Point<br>挂载点下原有文件在挂载完成后会被临时隐藏，因此，挂载点目录一般为空<br>进程正在使用中的设备无法被卸载</p>
<h3 id="2-4-1-挂载文件系统-mount"><a href="#2-4-1-挂载文件系统-mount" class="headerlink" title="2.4.1 挂载文件系统 mount"></a>2.4.1 挂载文件系统 mount</h3><p><strong>格式</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount [-fnrsvw] [-t vfstype] [-o options] device mountpoint</span><br></pre></td></tr></table></figure>

<p>device：指明要挂载的设备</p>
<ul>
<li>设备文件：例如:&#x2F;dev&#x2F;sda5</li>
<li>卷标：-L ‘LABEL’, 例如 -L ‘MYDATA’</li>
<li>UUID： -U ‘UUID’：例如 -U ‘0c50523c-43f1-45e7-85c0-a126711d406e’</li>
<li>伪文件系统名称：proc, sysfs, devtmpfs, configfs</li>
</ul>
<p>mountpoint：挂载点目录必须事先存在，建议使用空目录<br>mount 常用命令选项  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-t fstype 指定要挂载的设备上的文件系统类型,如:ext4,xfs</span><br><span class="line">-r readonly，只读挂载</span><br><span class="line">-w read and write, 读写挂载,此为默认设置,可省略</span><br><span class="line">-n 不更新/etc/mtab，mount不可见</span><br><span class="line">-a 自动挂载所有支持自动挂载的设备(定义在了/etc/fstab文件中，且挂载选项中有</span><br><span class="line">auto功能)</span><br><span class="line">-L &#x27;LABEL&#x27; 以卷标指定挂载设备</span><br><span class="line">-U &#x27;UUID&#x27; 以UUID指定要挂载的设备</span><br><span class="line">-B, --bind 绑定目录到另一个目录上</span><br><span class="line">-o options：(挂载文件系统的选项)，多个选项使用逗号分隔</span><br><span class="line">async 异步模式,内存更改时,写入缓存区buffer,过一段时间再写到磁盘中，效率高，但不安全</span><br><span class="line">sync 同步模式,内存更改时，同时写磁盘，安全，但效率低下</span><br><span class="line">atime/noatime 包含目录和文件</span><br><span class="line">diratime/nodiratime 目录的访问时间戳</span><br><span class="line">auto/noauto 是否支持开机自动挂载，是否支持-a选项</span><br><span class="line">exec/noexec 是否支持将文件系统上运行应用程序</span><br><span class="line">dev/nodev 是否支持在此文件系统上使用设备文件</span><br><span class="line">suid/nosuid 是否支持suid和sgid权限</span><br><span class="line">remount 重新挂载</span><br><span class="line">ro/rw 只读、读写</span><br><span class="line">user/nouser 是否允许普通用户挂载此设备，/etc/fstab使用</span><br><span class="line">acl/noacl 启用此文件系统上的acl功能</span><br><span class="line">loop 使用loop设备</span><br><span class="line">_netdev 当网络可用时才对网络资源进行挂载，如：NFS文件系统</span><br><span class="line">defaults 相当于rw, suid, dev, exec, auto, nouser, async</span><br></pre></td></tr></table></figure>
<p><strong>挂载规则:</strong></p>
<ul>
<li>一个挂载点同一时间只能挂载一个设备</li>
<li>一个挂载点同一时间挂载了多个设备，只能看到最后一个设备的数据，其它设备上的数据将被隐藏</li>
<li>一个设备可以同时挂载到多个挂载点</li>
<li>通常挂载点一般是已存在空的目录</li>
</ul>
<p><strong>范例:挂载案例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data# mount /dev/sdb1 /data/mysql_mount/</span><br><span class="line">root@ubuntu200404:/data# df</span><br></pre></td></tr></table></figure>

<p><img src="/../image.assets/1659865748687.png" alt="1659865748687"></p>
<h3 id="2-4-2-卸载文件系统-umount"><a href="#2-4-2-卸载文件系统-umount" class="headerlink" title="2.4.2 卸载文件系统 umount"></a>2.4.2 卸载文件系统 umount</h3><p>卸载时：可使用设备，也可以使用挂载点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umount 设备名|挂载点</span><br></pre></td></tr></table></figure>

<h3 id="2-4-3-查看挂载情况"><a href="#2-4-3-查看挂载情况" class="headerlink" title="2.4.3 查看挂载情况"></a>2.4.3 查看挂载情况</h3><p><strong>查看挂载</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#通过查看/etc/mtab文件显示当前已挂载的所有设备</span><br><span class="line">mount</span><br><span class="line">#查看内核追踪到的已挂载的所有设备</span><br><span class="line">cat /proc/mounts</span><br></pre></td></tr></table></figure>

<p><strong>查看挂载点情况</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">findmnt MOUNT_POINT|device</span><br></pre></td></tr></table></figure>

<p><strong>查看正在访问指定文件系统的进程</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lsof MOUNT_POINT</span><br><span class="line">fuser -v MOUNT_POINT</span><br></pre></td></tr></table></figure>

<p><strong>终止所有在正访问指定的文件系统的进程</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fuser -km MOUNT_POINT</span><br></pre></td></tr></table></figure>

<h3 id="2-4-4-持久挂载"><a href="#2-4-4-持久挂载" class="headerlink" title="2.4.4 持久挂载"></a>2.4.4 持久挂载</h3><p>将挂载保存到 &#x2F;etc&#x2F;fstab 中可以下次开机时，自动启用挂载<br>&#x2F;etc&#x2F;fstab格式帮助：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man 5 fstab</span><br></pre></td></tr></table></figure>

<p>每行定义一个要挂载的文件系统,，其中包括共 6 项</p>
<ul>
<li>要挂载的设备或伪文件系统设备文件<br>LABEL：LABEL&#x3D;””<br>UUID：UUID&#x3D;””<br>伪文件系统名称：proc, sysfs</li>
<li>挂载点：必须是事先存在的目录</li>
<li>文件系统类型：ext4，xfs，iso9660，nfs，none</li>
<li>挂载选项：defaults ，acl，bind</li>
<li>转储频率：0：不做备份 1：每天转储 2：每隔一天转储</li>
<li>fsck检查的文件系统的顺序：允许的数字是0 1 2<br>0：不自检 ，1：首先自检；一般只有rootfs才用 2：非rootfs使用</li>
</ul>
<p><strong>添加新的挂载项，需要执行下面命令生效</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -a</span><br></pre></td></tr></table></figure>

<p><strong>范例：centos7, 8 &#x2F;etc&#x2F;fstab 的分区UUID错误，无法启动</strong>*</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">自动进入emergency mode,输入root 密码</span><br><span class="line">#cat /proc/mounts 可以查看到/ 以rw方式挂载</span><br><span class="line">#vim /etc/fstab</span><br><span class="line">#reboot</span><br></pre></td></tr></table></figure>

<p><strong>范例：centos 6 &#x2F;etc&#x2F;fstab 的分区UUID错误，无法启动</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">如果/etc/fstab 的挂载设备出错，比如文件系统故障，并且文件系统检测项（即第6项为非0），将导致无</span><br><span class="line">法启动</span><br><span class="line">自动进入emergency mode,输入root 密码</span><br><span class="line">#cat /proc/mounts 可以查看到/ 以ro方式挂载，无法直接修改配置文件</span><br><span class="line">#mount -o remount,rw /</span><br><span class="line">#vim /etc/fstab</span><br><span class="line">将故障行的最后1项，即第6项修改为0，开机不检测此项挂载设备的健康性，从而忽略错误，能实现启动</span><br></pre></td></tr></table></figure>

<p><strong>范例：&#x2F;etc&#x2F;fstab格式</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu200404:/data# cat /etc/fstab </span><br><span class="line"># /etc/fstab: static file system information.</span><br><span class="line">#</span><br><span class="line"># Use &#x27;blkid&#x27; to print the universally unique identifier for a</span><br><span class="line"># device; this may be used with UUID= as a more robust way to name devices</span><br><span class="line"># that works even if disks are added and removed. See fstab(5).</span><br><span class="line">#</span><br><span class="line"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span><br><span class="line"># / was on /dev/ubuntu-vg/ubuntu-lv during curtin installation</span><br><span class="line">/dev/disk/by-id/dm-uuid-LVM-3aQ0WgB04ZXwNPYVAYy9ssb3Wd06E34ggUUxCcYQaVwAb0L03K40wpOxbnqqqa3f / ext4 defaults 0 1</span><br><span class="line"># /boot was on /dev/sda2 during curtin installation</span><br><span class="line">/dev/disk/by-uuid/5e8f9763-2db8-48d0-85e2-a26d76521e2f /boot ext4 defaults 0 1</span><br><span class="line">/swap.img	none	swap	sw	0	0</span><br><span class="line">root@ubuntu200404:/data# </span><br></pre></td></tr></table></figure>

<p><strong>范例：添加新的挂载点后修改&#x2F;etc&#x2F;fstab文件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># /etc/fstab: static file system information.</span><br><span class="line"># </span><br><span class="line"># Use &#x27;blkid&#x27; to print the universally unique identifier for a</span><br><span class="line"># device; this may be used with UUID= as a more robust way to name devices</span><br><span class="line"># that works even if disks are added and removed. See fstab(5).</span><br><span class="line">#</span><br><span class="line"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span><br><span class="line"># / was on /dev/ubuntu-vg/ubuntu-lv during curtin installation</span><br><span class="line">/dev/disk/by-id/dm-uuid-LVM-3aQ0WgB04ZXwNPYVAYy9ssb3Wd06E34ggUUxCcYQaVwAb0L03K40wpOxbnqqqa3f / ext4 defaults 0 1</span><br><span class="line"># /boot was on /dev/sda2 during curtin installation</span><br><span class="line">/dev/disk/by-uuid/5e8f9763-2db8-48d0-85e2-a26d76521e2f /boot ext4 defaults 0 1</span><br><span class="line">/swap.img       none    swap    sw      0       0</span><br><span class="line"></span><br><span class="line"># 添加该行后、重启系统</span><br><span class="line">UUID=0e850a4a-028d-48b2-aa18-dd8b16090aa6  /data/mysql_mount  ext4  defaults  0  0</span><br></pre></td></tr></table></figure>

<h2 id="2-5-处理交换文件和分区"><a href="#2-5-处理交换文件和分区" class="headerlink" title="2.5 处理交换文件和分区"></a>2.5 处理交换文件和分区</h2><h3 id="2-5-1-swap分区"><a href="#2-5-1-swap分区" class="headerlink" title="2.5.1 swap分区"></a>2.5.1 swap分区</h3><p>swap交换分区是系统RAM的补充，swap 分区支持虚拟内存。当没有足够的 RAM 保存系统处理的数据<br>时会将数据写入 swap 分区，当系统缺乏 swap 空间时，内核会因 RAM 内存耗尽而终止进程。配置过<br>多 swap 空间会造成存储设备处于分配状态但闲置，造成浪费，过多 swap 空间还会掩盖内存泄露<br>注意：为优化性能，可以将swap 分布存放，或高性能磁盘存放  </p>
<h3 id="2-5-2-交换分区实现过程"><a href="#2-5-2-交换分区实现过程" class="headerlink" title="2.5.2 交换分区实现过程"></a>2.5.2 交换分区实现过程</h3><ol>
<li>创建交换分区或者文件</li>
<li>使用mkswap写入特殊签名</li>
<li>在&#x2F;etc&#x2F;fstab文件中添加适当的条目</li>
<li>使用swapon -a 激活交换空间</li>
</ol>
<p><strong>启用swap分区</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swapon [OPTION]... [DEVICE]</span><br></pre></td></tr></table></figure>

<p><strong>常用选项</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-a #激活所有的交换分区</span><br><span class="line">-p PRIORITY #指定优先级(-1到32767之间)，值越大,优先级越高.也可在/etc/fstab文件中的第4列指</span><br><span class="line">定：pri=value</span><br></pre></td></tr></table></figure>

<p><strong>范例:创建swap分区</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#mkswap /dev/sdc1</span><br></pre></td></tr></table></figure>

<p><strong>禁用swap分区</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swapoff [OPTION]... [DEVICE]</span><br></pre></td></tr></table></figure>

<p><strong>范例:禁用swap分区</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@centos8 ~]#sed -i.bak &#x27;/swap/d&#x27; /etc/fstab</span><br><span class="line">[root@centos8 ~]#swapoff -a</span><br></pre></td></tr></table></figure>

<h3 id="2-5-3-swap的使用策略"><a href="#2-5-3-swap的使用策略" class="headerlink" title="2.5.3 swap的使用策略"></a>2.5.3 swap的使用策略</h3><p>&#x2F;proc&#x2F;sys&#x2F;vm&#x2F;swappiness 的值决定了当内存占用达到一定的百分比时，会启用swap分区的空间<br>使用规则</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">当内存使用率达到100-swappiness时,会启用交换分区</span><br><span class="line">简单地说这个参数定义了系统对swap的使用倾向，此值越大表示越倾向于使用swap。</span><br><span class="line">可以设为0，这样做并不会禁止对swap的使用，只是最大限度地降低了使用swap的可能性</span><br></pre></td></tr></table></figure>

<p><strong>范例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#说明：CentOS7和8默认值为30，内存在使用到100-30=70%的时候，就开始出现有交换分区的使用。</span><br><span class="line">[root@centos8 ~]# cat /proc/sys/vm/swappiness</span><br></pre></td></tr></table></figure>

<h2 id="2-6-磁盘常见工具"><a href="#2-6-磁盘常见工具" class="headerlink" title="2.6 磁盘常见工具"></a>2.6 磁盘常见工具</h2><h3 id="2-6-1-df"><a href="#2-6-1-df" class="headerlink" title="2.6.1 df"></a>2.6.1 df</h3><p>文件系统空间实际真正占用等信息的查看工具 df</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df [OPTION]... [FILE]...</span><br></pre></td></tr></table></figure>

<p><strong>常用选项</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-H 以10为单位</span><br><span class="line">-T 文件系统类型</span><br><span class="line">-h human-readable</span><br><span class="line">-i inodes instead of blocks</span><br><span class="line">-P 以Posix兼容的格式输出</span><br></pre></td></tr></table></figure>

<h3 id="2-6-3-du"><a href="#2-6-3-du" class="headerlink" title="2.6.3 du"></a>2.6.3 du</h3><p>查看某目录总体空间实际占用状态 du</p>
<p>显示指定目录下面各个子目录的大小,单位为KB</p>
<p><strong>常用选项</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-a --all 显示所有文件和目录的大小,默认只显示目录大小</span><br><span class="line">-h human-readable</span><br><span class="line">-s summary</span><br><span class="line">--max-depth=# 指定最大目录层级</span><br><span class="line">-x, --one-file-system #忽略不在同一个文件系统的目录</span><br></pre></td></tr></table></figure>

<p><strong>面试题</strong></p>
<p>1.df 和 du 区别?什么时候df &gt;du（空分区的时候)<br>df 查看是文件系统的空间使用，包括元数据和数据，删除文件后，如果此文件正在使用，不会立即释放空间;du 查看是文件数据空间使用，不包括元数据，删除文件后空间立即释放。</p>
<p>2.什么时候df &lt; du?<br>目录内挂载有其它分区时的情况</p>
<p>3.当删除文件但不释放空间时,有什么不同?<br>du 查看文件空间释放,df不释放</p>
<h1 id="3-RAID"><a href="#3-RAID" class="headerlink" title="3. RAID"></a>3. RAID</h1>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/categories/">分类</a></li>
         
          <li><a href="/search/">搜索</a></li>
         
          <li><a href="/about/">关于</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E7%AE%A1%E7%90%86%E4%B8%8E%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.</span> <span class="toc-text">磁盘管理与文件系统</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E7%A3%81%E7%9B%98%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">1. 磁盘结构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E7%AE%A1%E7%90%86%E5%AD%98%E5%82%A8"><span class="toc-number">3.</span> <span class="toc-text">2. 管理存储</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 磁盘分区</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%88%86%E5%8C%BA"><span class="toc-number">3.1.1.</span> <span class="toc-text">2.1.1 为什么分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-2-%E5%88%86%E5%8C%BA%E6%96%B9%E5%BC%8F"><span class="toc-number">3.1.2.</span> <span class="toc-text">2.1.2 分区方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E7%AE%A1%E7%90%86%E5%88%86%E5%8C%BA"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 管理分区</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-%E6%B7%BB%E5%8A%A0%E5%B9%B6%E6%A3%80%E6%B5%8B%E6%96%B0%E7%A1%AC%E7%9B%98"><span class="toc-number">3.2.1.</span> <span class="toc-text">2.2.1 添加并检测新硬盘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-partend%E5%91%BD%E4%BB%A4"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.2.2 partend命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-3-%E5%88%86%E5%8C%BA%E5%B7%A5%E5%85%B7fdisk%E5%92%8Cgdisk"><span class="toc-number">3.2.3.</span> <span class="toc-text">2.2.3 分区工具fdisk和gdisk</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 文件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-1-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5"><span class="toc-number">3.3.1.</span> <span class="toc-text">2.3.1 文件系统概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-2-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.3.2.</span> <span class="toc-text">2.3.2 文件系统类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-3-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86"><span class="toc-number">3.3.3.</span> <span class="toc-text">2.3.3 文件系统的组成部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-4-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E9%80%89%E6%8B%A9%E7%AE%A1%E7%90%86"><span class="toc-number">3.3.4.</span> <span class="toc-text">2.3.4 文件系统选择管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-1-%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.3.4.1.</span> <span class="toc-text">2.3.4.1 创建文件系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-2-%E6%9F%A5%E7%9C%8B%E5%92%8C%E7%AE%A1%E7%90%86%E5%88%86%E5%8C%BA%E4%BF%A1%E6%81%AF"><span class="toc-number">3.3.4.2.</span> <span class="toc-text">2.3.4.2 查看和管理分区信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-3-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%A3%80%E6%B5%8B%E5%92%8C%E4%BF%AE%E5%A4%8D"><span class="toc-number">3.3.4.3.</span> <span class="toc-text">2.3.4.3 文件系统检测和修复</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E6%8C%82%E8%BD%BD"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 挂载</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-1-%E6%8C%82%E8%BD%BD%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-mount"><span class="toc-number">3.4.1.</span> <span class="toc-text">2.4.1 挂载文件系统 mount</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-2-%E5%8D%B8%E8%BD%BD%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-umount"><span class="toc-number">3.4.2.</span> <span class="toc-text">2.4.2 卸载文件系统 umount</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-3-%E6%9F%A5%E7%9C%8B%E6%8C%82%E8%BD%BD%E6%83%85%E5%86%B5"><span class="toc-number">3.4.3.</span> <span class="toc-text">2.4.3 查看挂载情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-4-%E6%8C%81%E4%B9%85%E6%8C%82%E8%BD%BD"><span class="toc-number">3.4.4.</span> <span class="toc-text">2.4.4 持久挂载</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E5%A4%84%E7%90%86%E4%BA%A4%E6%8D%A2%E6%96%87%E4%BB%B6%E5%92%8C%E5%88%86%E5%8C%BA"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 处理交换文件和分区</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-1-swap%E5%88%86%E5%8C%BA"><span class="toc-number">3.5.1.</span> <span class="toc-text">2.5.1 swap分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-2-%E4%BA%A4%E6%8D%A2%E5%88%86%E5%8C%BA%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B"><span class="toc-number">3.5.2.</span> <span class="toc-text">2.5.2 交换分区实现过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-3-swap%E7%9A%84%E4%BD%BF%E7%94%A8%E7%AD%96%E7%95%A5"><span class="toc-number">3.5.3.</span> <span class="toc-text">2.5.3 swap的使用策略</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-%E7%A3%81%E7%9B%98%E5%B8%B8%E8%A7%81%E5%B7%A5%E5%85%B7"><span class="toc-number">3.6.</span> <span class="toc-text">2.6 磁盘常见工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-1-df"><span class="toc-number">3.6.1.</span> <span class="toc-text">2.6.1 df</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-3-du"><span class="toc-number">3.6.2.</span> <span class="toc-text">2.6.3 du</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-RAID"><span class="toc-number">4.</span> <span class="toc-text">3. RAID</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://cactus.itshare.work/2022/08/07/Disk/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://cactus.itshare.work/2022/08/07/Disk/&text=磁盘存储和文件系统管理"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://cactus.itshare.work/2022/08/07/Disk/&title=磁盘存储和文件系统管理"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://cactus.itshare.work/2022/08/07/Disk/&is_video=false&description=磁盘存储和文件系统管理"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=磁盘存储和文件系统管理&body=Check out this article: http://cactus.itshare.work/2022/08/07/Disk/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://cactus.itshare.work/2022/08/07/Disk/&title=磁盘存储和文件系统管理"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://cactus.itshare.work/2022/08/07/Disk/&title=磁盘存储和文件系统管理"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://cactus.itshare.work/2022/08/07/Disk/&title=磁盘存储和文件系统管理"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://cactus.itshare.work/2022/08/07/Disk/&title=磁盘存储和文件系统管理"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://cactus.itshare.work/2022/08/07/Disk/&name=磁盘存储和文件系统管理&description=磁盘是计算机主要的存储介质，可以存储大量的二进制数据，并且断电后也能保持数据不丢失，使用磁盘存储数据的时候我们可以将磁盘划分成我们所需要的格式来进行使用。"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://cactus.itshare.work/2022/08/07/Disk/&t=磁盘存储和文件系统管理"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2023
    Cookie
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     -->
      </ul>
    </nav>
<!--<p class="size-small">
    <a href="http://www.beian.miit.gov.cn" target="_blank" rel="noopener">黔ICP备2022006994号</a>
  </p>-->
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
